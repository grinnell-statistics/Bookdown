<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 Survival Analysis: Melting Chocolate Chips | Chapter 9</title>
<meta name="author" content="Your Name">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="Chapter 8 Survival Analysis: Melting Chocolate Chips | Chapter 9">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 Survival Analysis: Melting Chocolate Chips | Chapter 9">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="Far better an approximate answer to the right question, which is often vague, than the exact answer to the wrong question, which can always be made precise. — John Tukey Survival analysis methods...">
<meta property="og:description" content="Far better an approximate answer to the right question, which is often vague, than the exact answer to the wrong question, which can always be made precise. — John Tukey Survival analysis methods...">
<meta name="twitter:description" content="Far better an approximate answer to the right question, which is often vague, than the exact answer to the wrong question, which can always be made precise. — John Tukey Survival analysis methods...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Chapter 9</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled"><li><a class="" href="index.html"><span class="header-section-number">Chapter 8</span> Survival Analysis: Melting Chocolate Chips</a></li></ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/rstudio/bookdown-demo">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="survival-analysis-melting-chocolate-chips" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Survival Analysis: Melting Chocolate Chips<a class="anchor" aria-label="anchor" href="#survival-analysis-melting-chocolate-chips"><i class="fas fa-link"></i></a>
</h1>
<p><em>Far better an approximate answer to the right question, which is often vague, than the exact answer to the wrong question, which can always be made precise.</em><br>
— John Tukey</p>
<p>Survival analysis methods are used to investigate the time until a target event of interest (e.g., death, drug relapse, or college graduation) occurs, and they are used in a variety of disciplines such as medicine, sociology, and education. Although survival analysis techniques do not get the same amount of exposure in the literature as other statistical methods such as regression analysis or analysis of variance, it is important to consider their use whenever the response variable of interest is the <em>time</em> until an event occurs.</p>
<p>In this chapter, you will have the opportunity to perform a simple experiment to investigate the time required for different types of chocolate chips to melt. A set of activities related to this experiment will introduce you to a variety of methods for exploring the times until a target event occurs, also referred to as survival or time-to-event data. Upon completion of the activities, you should be able to do the following:</p>
<ul>
<li>Recognize special characteristics of survival data<br>
</li>
<li>Summarize survival data and estimate survival probabilities using the Kaplan–Meier estimator<br>
</li>
<li>Compute descriptive statistics, including the mean and percentiles, for a sample of event times<br>
</li>
<li>Construct confidence intervals for survival probabilities<br>
</li>
<li>Compare survival experiences for different groups of subjects<br>
</li>
<li>Investigate periods of time when subjects are at low and high risk of experiencing an event of interest</li>
</ul>
<p>The extended activities and research project provide opportunities to evaluate research articles discussing applications of survival analysis, hazard functions, and various types of incomplete data.</p>
<div id="investigation-how-long-does-it-take-for-chocolate-chips-to-melt" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> <strong>Investigation: How Long Does It Take for Chocolate Chips to Melt?</strong><a class="anchor" aria-label="anchor" href="#investigation-how-long-does-it-take-for-chocolate-chips-to-melt"><i class="fas fa-link"></i></a>
</h2>
<p>If you enjoy eating chocolate chips, then you can probably appreciate their sweet flavor and smooth texture
as they melt in your mouth. Chocolatiers and food scientists are well aware that the material composition
of chocolate affects the flavor, texture, and duration of the melting process, thereby resulting in a “good” or
“bad” tasting experience. These individuals continually strive to improve the manufacturing process, as well
as the properties of chocolate. By developing heat-resistant varieties that can withstand higher temperatures,
they work to increase the time before the chocolate melts.2 For food scientists and chocolate confectioners,
melting chocolate can be serious business.</p>
<p>The purpose of the following investigation is to explore the time required for chocolate chips to melt. To
perform the study, we will conduct an experiment that requires students to place a chip in their mouth and
wait for it to melt. The experiment will be somewhat restrictive because the time allowed to run the study
will be limited. Suppose we allow only 60 seconds for the study. It is possible that not all the chocolate chips
will melt. For those chips that have not melted by the time 60 seconds has elapsed, we will have only partial
information on melting times, and we will indicate that these times are incomplete. As we’ll see, incomplete
times can create difficulties when we are trying to compute simple quantities like the average melting time or
trying to estimate the proportion of chips that take longer than a particular time to melt.</p>
<p>To obtain a larger set of chip melting times that you can use for the activities and extended activities
in this chapter, your class might participate in the following experiment to collect chocolate chip melting
times. In addition, you will then be able to examine differences in the melting times by the type of chocolate
chip (white or milk chocolate). In this experiment, you will place a chocolate chip in your mouth, hold it
between your tongue and the roof of your mouth, and record the time required for it to completely dissolve
(i.e., melt), without actually biting into the chip. Although this activity may appear rather trivial, it is meant
to serve as a simple, yet illustrative, approach to generating real time-to-event data and exploring methods
used to investigate survival data. Our hope is that when we examine additional examples of real survival data
later in the chapter, you will be able to relate the features of those examples back to the features of the chip
melting time data.</p>
<p>With the melting times for different types of chips and the methods you will learn in this chapter, you will be able to do the following:</p>
<ul>
<li>Estimate the proportion of chips that remain unmelted beyond a specific point in time<br>
</li>
<li>Estimate the average time it takes for white or milk chocolate chips to melt<br>
</li>
<li>Determine if the type of chip is related to the chip melting experience. For example, do milk and white chocolate chips melt at the same rates over time?<br>
</li>
<li>For those chocolate chips that have not melted by a particular time, determine at what rate they are melting in the next “instant” of time</li>
</ul>
<p><br>
For this activity, you will need a time-keeping device that every student can clearly see, a bag of white chocolate chips, and a bag of milk chocolate chips.<br></p>
</div>
<div id="activity-melting-chocolate-chips" class="section level2 unnumbered">
<h2>Activity: Melting Chocolate Chips<a class="anchor" aria-label="anchor" href="#activity-melting-chocolate-chips"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Perform the chocolate chip melting activity outlined below. Be sure to record chip color, melting time, and whether the chip completely melted by 60 seconds. Combine all class data into one data file for future analysis purposes, and name this file <code>MeltingChips</code>.
<ol style="list-style-type: lower-alpha">
<li>Devise a system for randomly assigning each student to have a white or milk chocolate chip (this can be done by flipping a coin, for example).<br>
</li>
<li>When the instructor gives approval, place the white or milk chocolate chip in your mouth and record the time until it completely melts. Note that the group should come to a reasonable consensus on a clear definition of “completely melts” prior to the activity to ensure consistency in the recorded times.<br>
</li>
<li>Create a data set in the following manner: Treat the study as if it could be done only for a specified period of time (you may need to experiment, but 60 seconds has worked well). If the actual time required for the chip to melt is less than 60 seconds, then the actual time will be complete and you submit (chip type, actual time, 1). If the chip has not melted by 60 seconds, then you regard the observation as incomplete and submit (chip type, 60, 0). Observations of any chips that are swallowed prior to 60 seconds should be regarded as incomplete as well, and you submit (chip type, actual swallowed time, 0).</li>
</ol>
</li>
</ol>
<p><br>
If your class does not perform the chip melting activity, then you can use the data set MeltingChipsJS
supplied by the authors to complete the activities and extended activities. Be certain to verify which
data set (MeltingChips or MeltingChipsJS) your instructor would like you to use in the following
activities.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;This data file contains the results of the chip melting activity administered by the second author of this textbook to his
introductory survival analysis course. The maximum time allowed was 75 seconds&lt;/p&gt;"><sup>5</sup></a>
</p>
</div>
<div id="overview-of-survival-analysis-studies-and-data" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> <strong>Overview of Survival Analysis Studies and Data</strong><a class="anchor" aria-label="anchor" href="#overview-of-survival-analysis-studies-and-data"><i class="fas fa-link"></i></a>
</h2>
<p>The collection of lengths of times required for the chips to melt is an example of <strong>survival data</strong>, also called <strong>time-to-event data</strong> or <strong>failure-time data</strong>. Survival data are the times until individuals experience an event of interest. The specific event of interest can be, for example, death, graduation, or test completion, while the individual experiencing the event may be living, such as a person or an animal, or inanimate, such as a light bulb, computer, or chocolate chip.</p>
<p><strong>Survival analysis</strong> is a field of statistics covering methods and techniques for examining and investigating survival data, and it is used in diverse fields including medicine, education, and psychology. In studies that use survival analysis techniques, the response variable of interest, denoted <span class="math inline">\(T\)</span>, is the time until the event of interest occurs, also called the <strong>failure time</strong>, <strong>survival time</strong>, or <strong>time-to-event random variable</strong>. For example, the time taken for a chocolate chip to melt is a time-to-event random variable, and the recorded melting times are the observed values of <span class="math inline">\(T\)</span>. In the material that follows, we will discuss many ways to summarize and describe the observed values of <span class="math inline">\(T\)</span> that you might get from an experiment or study. Additional examples of survival time random variables (with their related fields in parentheses) that will be discussed include:</p>
<ul>
<li>Time until drivers blocked by traffic honk their horn (sociology or psychology)<br>
</li>
<li>Time until students graduate from college (education)<br>
</li>
<li>Age at which first alcoholic drink is taken (public health)<br>
</li>
<li>Time until former inmates are rearrested (criminology)</li>
</ul>
<p>When a study involves measuring the time until a target event occurs and when it possesses a clearly
defined <strong>beginning of time</strong> as well as a <strong>meaningful scale</strong> for measuring time, then it is appropriate to use
survival analysis methods and techniques. The beginning of time is a point at which no individual under study
has yet to experience the event (e.g., the date on which a student enrolls in a post-secondary institution when
the investigation concerns the time until college graduation), while a meaningful scale might be seconds,
minutes, days, weeks, and so on</p>
<p><br>
Time-to-event data are fundamentally different from time series data. <strong>Time series data</strong> are measurements on the same observational units collected at different time points. For example, time series data may be the number of chips that melt at 40 seconds, 50 seconds, and so on. Time-to-event data are time durations until the observational unit experiences the target event.<br></p>
<p>
The response variable in a survival analysis study is the time until the event of interest occurs. Survival analysis methods are appropriate for data from experiments or studies that possess a well-defined event of interest, a clearly defined beginning of time, and a meaningful scale for measuring time.<br></p>
</div>
<div id="incomplete-event-times-censoring" class="section level2 unnumbered">
<h2>Incomplete Event Times: Censoring<a class="anchor" aria-label="anchor" href="#incomplete-event-times-censoring"><i class="fas fa-link"></i></a>
</h2>
<p>One feature common to many survival data sets that needs to be appropriately addressed is that some event times are <strong>incomplete</strong>; i.e., we have only partial information about the time until the event of interest occurs. We’ll refer to event times that are known exactly as <strong>complete</strong>. There are several reasons why observations may be incomplete, but in this chapter we will focus on a mechanism called <strong>right censoring</strong>, which occurs when observation begins at a defined starting time and ends before the outcome of interest is observed. The chocolate chip data could have right-censored observations if a chip did not melt in the allotted time or if a student accidentally swallowed a chip. For example, a chip that did not melt by 60 seconds would have a right-censored (incomplete) time of 60 seconds. Other types of incomplete data will be discussed in the extended activities.</p>
<p>In written reports and journals, it is common to display a right-censored event time with a + placed to the right of the observed time. For example, a recorded melting time of 60+ seconds would indicate that the chip was observed for 60 seconds, but did not (completely) melt. Another way to record an event time is to assign a pair of numbers consisting of an observed value for the survival time variable, <span class="math inline">\(T\)</span>, and a value for a censoring status variable, <span class="math inline">\(C\)</span>. The censoring variable might, for example, take the value of 0 if the event of interest was not observed and the value of 1 if it was (this 0–1 coding choice is arbitrary, although common). Although more formal, this method of recording survival data is particularly relevant when the times need to be entered into data files. This coding scheme was adopted for the in-class chip melting activity performed earlier.</p>
<p>Incomplete observations can introduce systematic error, also called <strong>bias</strong>, into the estimated quantities (like the mean or median) if not handled appropriately—for example, if right-censored observations are treated as complete or are removed from the study. Descriptive statistics of survival time, such as the mean, may be grossly underestimated if right censoring is present but ignored. Survival analysis methods and techniques to accommodate data with incomplete observations have been developed, and some of these will be covered in the sections that follow.</p>
<p><br>
Be sure to read the description of any file containing survival data so that you know which value of the censoring variable corresponds to a right-censored time and which value corresponds to a complete time.<br></p>
</div>
<div id="activity-melting-chocolate-chips-1" class="section level2 unnumbered">
<h2>Activity: Melting Chocolate Chips<a class="anchor" aria-label="anchor" href="#activity-melting-chocolate-chips-1"><i class="fas fa-link"></i></a>
</h2>
<ol start="2" style="list-style-type: decimal">
<li>For the chip melting study, describe the event of interest, the time-to-event random variable <span class="math inline">\(T\)</span>, the beginning of time, and the scale for measuring time.<br>
</li>
<li>Examine your class data. How many of your melting times are complete? How many are censored?</li>
</ol>
<p><br>
Survival data may contain right-censored observations; that is, an individual may not experience the event by the end of the study, or the individual may drop out of the study before the event time is observed. An event time that is right censored can be displayed with a + to the right of the recorded time or represented by using a pair of values that include the observed recorded time and a value to indicate that the time is censored.<br></p>
</div>
<div id="the-survival-function" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> <strong>The Survival Function</strong><a class="anchor" aria-label="anchor" href="#the-survival-function"><i class="fas fa-link"></i></a>
</h2>
<p>Now that we have discussed particular features of time-to-event data and looked at some notation and terminology, we turn to methods for examining and summarizing survival data. The primary function used to characterize the values of a time-to-event random variable <span class="math inline">\(T\)</span> is the survival function <span class="math inline">\(S(t)\)</span>, given by</p>
<p><span class="math display">\[\begin{align}
S(t) &amp;= P(T &gt; t)
\notag
\end{align}\]</span></p>
<p><span class="math inline">\(S(t)\)</span> provides the probability that a randomly selected individual in the population will survive (not experience the event of interest) beyond time <span class="math inline">\(t\)</span>. Another interpretation of <span class="math inline">\(S(t)\)</span> is that it provides the proportion of subjects in a population who have yet to experience the event of interest by time <span class="math inline">\(t\)</span>.</p>
<p>In the context of the chocolate chip melting times, the survival function <span class="math inline">\(S(t) = P(T &gt; t)\)</span> provides the probability that a randomly selected chip in the population of all chips will take longer than the specified time <span class="math inline">\(t\)</span> to melt. So, for example, <span class="math inline">\(S(45) = P(T &gt; 45)\)</span> gives the probability that a randomly selected chip will take longer than 45 seconds to melt. Equivalently, <span class="math inline">\(S(45)\)</span> provides the proportion of chips in the population that have not melted after 45 seconds.</p>
<p>At the beginning of time, no one has experienced the event, so the proportion of subjects in the population who have yet to experience the target event is 100% and <span class="math inline">\(S(0) = 1\)</span>. Then as time progresses, individuals will experience the event (e.g., chocolate chips will melt, college students will graduate, former inmates will be arrested again), so the survival function will decline toward its lower bound of 0 (although it may not actually reach this value).</p>
<p><br>
The survival function provides the probability that an individual will survive beyond a given time <span class="math inline">\(t\)</span>—that is, the probability that an individual does not experience the event of interest until after time <span class="math inline">\(t\)</span>. <em>Important:</em> <span class="math inline">\(S(t)\)</span> does not indicate the probability that an individual experiences the event at time <span class="math inline">\(t\)</span>.<br></p>
</div>
<div id="the-empirical-survival-function" class="section level2 unnumbered">
<h2>The Empirical Survival Function<a class="anchor" aria-label="anchor" href="#the-empirical-survival-function"><i class="fas fa-link"></i></a>
</h2>
<p>To determine the exact proportion of chips that take longer than <span class="math inline">\(t\)</span> seconds to melt, we would need to know the melting times of the entire population of chips or know the exact probability distribution for <span class="math inline">\(T\)</span>. In practice, we hardly ever know the exact probability distribution for <span class="math inline">\(T\)</span>. In the real world, we will collect (or be given) a sample of survival times, and we will need to find an estimator for <span class="math inline">\(S(t)\)</span>.</p>
<p><br>
This is very similar to what was done in your first statistics course. An exact value, such as the population mean <span class="math inline">\(\mu\)</span>, is estimated using a function of sample data, <span class="math inline">\(\bar x\)</span>.<br></p>
<p>To illustrate the calculation of various quantities in the following sections, we will use a small sample
of melting times (in seconds) of milk chocolate chips for 7 students, where the maximum time allowed for
the experiment was 60 seconds. These times are displayed in Table 9.1. Statistical software will be used
for the in-class chip melting activity data, as well as the additional data sets described in the extended
activities.</p>
<p>To estimate the proportion of chocolate chips that have not melted after 45 seconds, <span class="math inline">\(\hat S(45)\)</span>, we simply
calculate the sample proportion:</p>
<p><span class="math display">\[\begin{align}
\hat S(45) &amp;= \frac{\text{number of chips that have not melted after 45 seconds}}{\text{total number of chips in the sample}} \notag \\
&amp;= \frac{2}{7} \notag
\end{align}\]</span></p>
<p>When all observations are complete, we can generalize this calculation to any time <span class="math inline">\(t\)</span> using an estimator of <span class="math inline">\(S(t)\)</span> called the empirical survival function, denoted by <span class="math inline">\(\hat S(t)_{E}\)</span> and given by</p>
<p><span class="math display">\[\begin{align}
\hat S(t)_{E}
&amp;= \frac{\text{number of individuals yet to experience the event at time }t}{\text{total number of individuals in the study}} \notag \\
&amp;= \frac{\text{number of event times greater than }t}{\text{total number of individuals in the study}}
\tag{9.1}
\end{align}\]</span></p>
<p>When all observations are complete, the empirical survival function works well. However, this estimator may not be as precise when the data contain censored (i.e., incomplete) observations.</p>
<p>Now suppose that some of the milk chocolate chip melting times displayed in Table 9.1 are incomplete. Let’s assume that students 1 and 7 withdrew from the study (they accidentally swallowed the chips before they melted), while student 3 had not experienced a melted chip by the end of the experiment. Then students 1, 3, and 7 have censored times, and the melting times can be displayed as shown in Table 9.2, where the + denotes right-censored observations.</p>
</div>
<div id="activity-empirical-survival-function" class="section level2 unnumbered">
<h2>Activity: Empirical Survival Function<a class="anchor" aria-label="anchor" href="#activity-empirical-survival-function"><i class="fas fa-link"></i></a>
</h2>
<ol start="4" style="list-style-type: decimal">
<li>Use Equation (9.1) and the 7 milk chocolate melting times in Table 9.1 to compute <span class="math inline">\(\hat S(25)_{E}\)</span>, <span class="math inline">\(\hat S(30)_{E}\)</span>, <span class="math inline">\(\hat S(40)_{E}\)</span>, and <span class="math inline">\(\hat S(60)_{E}\)</span>.<br>
</li>
<li>With the melting times provided in Table 9.2, use the following two approaches to calculate the estimated probability that it takes more than 45 seconds for a chocolate chip to melt, based on the empirical survival function <span class="math inline">\(\hat S(45)_{E}\)</span>:
<ol style="list-style-type: lower-alpha">
<li>Treat all the censored times as complete (actual observed) times, and use Equation (9.1) to calculate <span class="math inline">\(\hat S(45)_{E}\)</span>.<br>
</li>
<li>Eliminate all censored observations, and then use Equation (9.1) and the remaining complete observations to calculate <span class="math inline">\(\hat S(45)_{E}\)</span>.</li>
</ol>
</li>
</ol>
<p>Note the different answers obtained in Parts (a) and (b) of Question 5. By treating the censored times as complete times, we assume that the event times are shorter than they actually are, thereby underestimating the true probability of survival (not melting). By disregarding the censored times, we lose information about melting times from the sample (consider the extreme case where all melting times are 60+). Treating the censored observations as complete or ignoring them will <em>bias</em> any estimates based on the remaining complete times.</p>
</div>
<div id="the-kaplanmeier-estimator" class="section level2 unnumbered">
<h2>The Kaplan–Meier Estimator<a class="anchor" aria-label="anchor" href="#the-kaplanmeier-estimator"><i class="fas fa-link"></i></a>
</h2>
<p>When a data set contains incomplete observations, the best estimator of the survival function is the <strong>Kaplan–Meier estimator</strong>, <span class="math inline">\(\hat S(t)_{\text{KM}}\)</span>. While this estimator is typically calculated with statistical software, this section will describe the logic behind how the Kaplan–Meier estimator is put together.</p>
<p>The first step in creating the Kaplan-Meier estimator is to establish a series of time intervals. Order the
complete event times from smallest to largest and label the smallest complete time as <span class="math inline">\(t_1\)</span>, the second smallest
as <span class="math inline">\(t_2\)</span>, and so on. We will denote the number of distinct <em>complete</em> event times by m, where m is less than or
equal to n, the total number of <em>observed</em> event times (complete and incomplete).</p>
<p>The complete times, <span class="math inline">\(t_1\)</span> through <span class="math inline">\(t_m\)</span>, are used to define intervals beginning at one complete event time and
ending just prior to the next complete event time, with some minor modifications for the first and last intervals
as outlined below:</p>
<ul>
<li>By convention, the 0th interval begins at time <span class="math inline">\(t_0 = 0\)</span> and ends just prior to the time when the first event occurs, time <span class="math inline">\(t_1\)</span>. This interval is given by <span class="math inline">\([0,\,t_1)\)</span>.</li>
<li>The next interval begins with the complete time <span class="math inline">\(t_i\)</span> and ends just prior to the next complete event time <span class="math inline">\(t_{i+1}\)</span>. Time intervals of the form <span class="math inline">\([t_i,\,t_{i+1})\)</span> are created for <span class="math inline">\(i = 1,2,\dots,m-1\)</span>.</li>
<li>If the largest observed event time is censored, then this time is denoted by <span class="math inline">\(t_m\)</span> and the interval extends to <span class="math inline">\(t_m\)</span> and is open on the right; i.e., the interval is given by <span class="math inline">\([t_m,\,t_n)\)</span>. If the largest observed event time is complete, then the last interval is technically not an interval and just consists of a single point; that is, the interval is given by <span class="math inline">\([t_m,\,t_m]\)</span>.</li>
</ul>
</div>
<div id="activity-time-intervals-for-the-chip-melting-times" class="section level2 unnumbered">
<h2>Activity: Time Intervals for the Chip Melting Times<a class="anchor" aria-label="anchor" href="#activity-time-intervals-for-the-chip-melting-times"><i class="fas fa-link"></i></a>
</h2>
<ol start="6" style="list-style-type: decimal">
<li>Consider the chocolate chip melting time data in Table 9.2. What is <span class="math inline">\(m\)</span>? List <span class="math inline">\(t_1\)</span> through <span class="math inline">\(t_m\)</span> for the chip melting times.<br>
</li>
<li>The first two intervals for the chocolate chip melting times are <span class="math inline">\([0,25)\)</span> and <span class="math inline">\([25,30)\)</span>. Write out the remaining intervals. Notice that any incomplete times, such as 30+ and 35+, are ignored in creating intervals.<br>
</li>
<li>Determine <span class="math inline">\(d_i\)</span>, the number of melted chips in each interval, and <span class="math inline">\(n_i\)</span>, the number of chips at risk of melting in each interval (all chips with complete or censored times that have not yet occurred), for <span class="math inline">\(i = 0,1,2,3,4\)</span>.</li>
</ol>
<p>Table 9.3 displays some of the quantities required to compute the Kaplan–Meier estimates. After the time intervals, the number of events of interest (<span class="math inline">\(d_i\)</span>) and the number at risk (<span class="math inline">\(n_i\)</span>) have been calculated, three more calculations are still needed for each interval: <span class="math inline">\(\hat p_i\)</span>, <span class="math inline">\(1 - \hat p_i\)</span>, and <span class="math inline">\(\hat S(t_i)_{\text{KM}}\)</span>.</p>
<p>After the time intervals have been appropriately defined, we estimate <span class="math inline">\(\hat p_i\)</span>, the conditional probability of experiencing the event in the <span class="math inline">\(i\)</span>th time interval, given that the event has not occurred by the start of the interval. That is, we compute</p>
<p><span class="math display">\[\begin{align}
\hat p_i &amp;= \frac{d_i}{n_i}
\notag
\end{align}\]</span></p>
<p>where <span class="math inline">\(d_i\)</span> is the number of subjects who experienced the target event in interval <span class="math inline">\(i\)</span> and <span class="math inline">\(n_i\)</span> is the total number of subjects (with complete and censored times) who are eligible (at risk) to experience the target event at the <em>beginning</em> of the <span class="math inline">\(i\)</span>th time interval.</p>
<p>Now if <span class="math inline">\(\hat p_i\)</span> is the probability of an individual experiencing the event in the <span class="math inline">\(i\)</span>th time interval, given that the
individual has not experienced the event in the previous time intervals, then <span class="math inline">\(1 - \hat p_i\)</span>
i is the probability of <em>not</em> experiencing the event (i.e., <em>surviving</em>) through the ith time interval, given that the individual has not experienced the event prior to the <span class="math inline">\(i\)</span>th time interval.</p>
<p>For example, the estimate of the conditional probability that a chip will <em>not</em> melt between the 25th second
and the 30th second, given that it has remained unmelted through the 25th second, is given by</p>
<p><span class="math display">\[\begin{align}
1 - \hat p_1 &amp;= 1 - \frac{d_1}{n_1} \notag \\
&amp;= 1 - \frac{1}{7} \notag \\
&amp;= \frac{6}{7} \notag
\end{align}\]</span></p>
<p>That is, <span class="math inline">\(6/7\)</span>, or about 86%, of the chips that have not melted just prior to the 25th second will remain unmelted (survive) between the 25th and the 30th second.</p>
</div>
<div id="activity-estimated-conditional-melting-probabilities" class="section level2 unnumbered">
<h2>Activity: Estimated Conditional Melting Probabilities<a class="anchor" aria-label="anchor" href="#activity-estimated-conditional-melting-probabilities"><i class="fas fa-link"></i></a>
</h2>
<p>Use the chocolate chip data in Table 9.2 to answer the following questions:</p>
<ol start="9" style="list-style-type: decimal">
<li>What is the value of <span class="math inline">\(\hat p_1\)</span>? Interpret this value.<br>
</li>
<li>
<span class="math inline">\(\hat p_1\)</span> is the estimate of the conditional probability that a chip will melt between the 25th second and the 30th second, given that it has remained unmelted through the 25th second. Show that about 14% of the chips that have not melted just prior to the 25th second will melt between the 25th and the 30th second.<br>
</li>
<li>Calculate the remaining estimated conditional probabilities <span class="math inline">\(\hat p_3\)</span> and <span class="math inline">\(\hat p_4\)</span>. Place these values in the appropriate cells in Table 9.3 and interpret the values.<br>
</li>
<li>Calculate the remaining estimated conditional probabilities <span class="math inline">\(1 - \hat p_3\)</span> and <span class="math inline">\(1 - \hat p_4\)</span>. Place these values in the appropriate cells in Table 9.3 and interpret the values.</li>
</ol>
<p>The final step in constructing the Kaplan–Meier estimated survival probabilities is to multiply together each conditional probability of surviving through the <span class="math inline">\(i\)</span>th time interval to get the <em>unconditional</em> probability of surviving through the <span class="math inline">\(i\)</span>th time interval.</p>
<p>For example, the Kaplan–Meier estimate of the probability that a chip will remain unmelted through the 25th second is given by</p>
<p><span class="math display">\[\begin{align}
\hat S(25)_{\mathrm{KM}} = (1 - \hat p_0)\,(1 - \hat p_1) &amp;= (1)\,\bigl(1 - d_1/n_1\bigr) \notag \\
&amp;= 1 - \tfrac{1}{7} \notag \\
&amp;= \tfrac{6}{7} \notag
\end{align}\]</span></p>
<p>Therefore, 6/7, or about 86%, of the chips remain unmelted (survive) beyond the 25th second.</p>
<p><br>
The Kaplan–Meier estimator provides the proportions of subjects in the sample that survive beyond a given time. To compute the Kaplan–Meier estimator for a data set with <span class="math inline">\(n\)</span> individuals, define the following quantities:<br><span class="math inline">\(m\)</span>: the number of distinct uncensored event times, where <span class="math inline">\(m \le n\)</span>. By distinct we mean that two or more identical times contribute only once to determine <span class="math inline">\(m\)</span>.<br><span class="math inline">\(t_1, t_2, \dots, t_m\)</span>: the ordered complete times (i.e., those times when the event of interest actually occurred), ordered from smallest to largest. By convention, <span class="math inline">\(t_0 = 0\)</span>.<br><span class="math inline">\(n_i\)</span>: the number at risk of experiencing the event at time <span class="math inline">\(t_i\)</span> (i.e., just prior to the start of the time interval <span class="math inline">\([t_i,\,t_{i+1})\)</span>), for <span class="math inline">\(i = 0,1,\dots,m-1\)</span>.<br><span class="math inline">\(d_i\)</span>: the number experiencing the event at time <span class="math inline">\(t_i\)</span> (i.e., in time interval <span class="math inline">\([t_i,\,t_{i+1})\)</span>), for <span class="math inline">\(i = 0,1,\dots,m-1\)</span>.</p>
<p>Then the Kaplan–Meier estimator of the survival function is given by</p>
<p><span class="math display">\[\begin{align}
\hat S(t)_{\mathrm{KM}} &amp;= \prod_{t_i \le t} \bigl(1 - d_i/n_i\bigr)
\tag{9.2}
\end{align}\]</span></p>
<p>where <span class="math inline">\(\prod\)</span> is the symbol for taking the products of terms <span class="math inline">\((1 - d_i/n_i)\)</span> for all <span class="math inline">\(i\)</span> such that the complete event times <span class="math inline">\(t_1,\dots,t_m\)</span> are less than or equal to the time of interest <span class="math inline">\(t\)</span>. Also, <span class="math inline">\(\hat S(t)_{\mathrm{KM}} = 1\)</span> for all times <span class="math inline">\(t &lt; t_1\)</span>.
</p>
<p><br>
The Kaplan–Meier estimator is derived using the multiplication rule from introductory probability. Let <span class="math inline">\(A_i\)</span> be defined as any event occurring after interval <span class="math inline">\(i\)</span>. Then, for example,
<span class="math display">\[\begin{align}
\hat S(25)_{\mathrm{KM}} &amp;= (1 - \hat p_1)\,(1 - \hat p_0) \\
&amp;= P(A_1 \mid A_0)\,P(A_0)
\end{align}\]</span>
and
<span class="math display">\[\begin{align}
\hat S(30)_{\mathrm{KM}} &amp;= (1 - \hat p_2)\,(1 - \hat p_1)\,(1 - \hat p_0) \\
&amp;= P(A_2 \mid A_1)\,P(A_1 \mid A_0)\,P(A_0)
\end{align}\]</span>
</p>
</div>
<div id="activity-kaplanmeier-estimates" class="section level2 unnumbered">
<h2>Activity: Kaplan–Meier Estimates<a class="anchor" aria-label="anchor" href="#activity-kaplanmeier-estimates"><i class="fas fa-link"></i></a>
</h2>
<p>Refer to the entries in Table 9.3 to answer the following questions.<br>
13. Use the remaining chocolate chip melting times to complete Table 9.3.<br>
14. What is the estimate for <span class="math inline">\(S(45)\)</span> in Table 9.3? That is, what proportion of chips in the sample has not melted after 45 seconds?<br>
15. Use the entries in Table 9.3 to estimate the proportion of chips that have melted by 35 seconds.<br>
16. Use the entries in Table 9.3 to estimate the proportion of chips that have not melted after 50 seconds.<br>
17. Assume that no censoring is present in the melting times (see the entries in Table 9.1). Estimate <span class="math inline">\(S(25)\)</span>, <span class="math inline">\(S(30)\)</span>, <span class="math inline">\(S(45)\)</span>, and <span class="math inline">\(S(55)\)</span> using both the empirical survival function and the Kaplan–Meier estimator, and compare your answers. What do your answers suggest about the Kaplan–Meier estimator when no censoring is present?</p>
</div>
<div id="graphing-the-kaplanmeier-curve" class="section level2 unnumbered">
<h2>Graphing the Kaplan–Meier Curve<a class="anchor" aria-label="anchor" href="#graphing-the-kaplanmeier-curve"><i class="fas fa-link"></i></a>
</h2>
<p>Once the survival probabilities have been estimated, a graph of the Kaplan–Meier curve can be constructed to display the relationship between time and the estimated probability of surviving. The Kaplan–Meier curve is an approximation to the true survival curve, which is a graphical representation of <span class="math inline">\(S(t)\)</span>. The values of <span class="math inline">\(\hat S(t)_{\mathrm{KM}}\)</span> are plotted against the complete event times <span class="math inline">\(t_1, t_2, \dots, t_m\)</span>. Figure 9.1 shows the Kaplan–Meier curve for the chocolate chip melting times displayed in Table 9.2.</p>
<p>Notice that the value of <span class="math inline">\(\hat S(30)_{\mathrm{KM}}\)</span> remains the same across each time interval. From Table 9.3, we see that, for example, <span class="math inline">\(\hat S(30)_{\mathrm{KM}} = 5/7\)</span>; i.e., the proportion of chips in the sample that have not melted after 30 seconds is 5/7, or 71%. This value remains constant for time <span class="math inline">\(t\)</span> in the interval <span class="math inline">\([30,45)\)</span>. From Figure 9.1 we can observe that the Kaplan–Meier curve is a decreasing series of steps, with drops occurring at each complete event time <span class="math inline">\(t_i\)</span>. This type of plot is called a <em>step function</em> because it looks like a series of steps. The height of each step corresponds to the value of <span class="math inline">\(\hat S(t_i)_{\mathrm{KM}}\)</span> for <span class="math inline">\(t\)</span> inside <span class="math inline">\([t_i,\,t_{i+1})\)</span>, where <span class="math inline">\(i = 0,\dots,m-1\)</span> (with the convention that <span class="math inline">\(t_0 = 0\)</span>).</p>
<p>We can see that the estimated probability that a randomly selected chip remains unmelted decreases as time increases or, stated another way, the proportion of unmelted chips decreases over time. Another feature of Figure 9.1 is that the proportion of chips that remain unmelted after 60 seconds is nonzero, so the last step of the Kaplan–Meier curve extends to the right up to 60 seconds.</p>
<p>You’ll notice a box to the right of the graph, labeled “Table of Statistics,” that contains the mean and
median survival times for the sample, as well as the interquartile range (IQR). We’ll discuss these descriptive
statistics in Section 9.4.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_1.png" alt="Kaplan-Meier estimated proportions (estimated survival probabilities) of chocolate chips." width="100%"><p class="caption">
(#fig:fig9.1)Kaplan-Meier estimated proportions (estimated survival probabilities) of chocolate chips.
</p>
</div>
</div>
<div id="activity-kaplanmeier-curves" class="section level2 unnumbered">
<h2>Activity: Kaplan–Meier Curves<a class="anchor" aria-label="anchor" href="#activity-kaplanmeier-curves"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<ol start="18" style="list-style-type: decimal">
<li>Compare the values of <span class="math inline">\(\hat S(t)_{\mathrm{KM}}\)</span> in Table 9.3 to those in Figure 9.1. How would the Kaplan–Meier curve in Figure 9.1 change if the largest observed melting time were not censored?<br>
</li>
<li>Use the technology instructions provided on the CD to construct the Kaplan–Meier curve for the white and the milk chocolate chips from the chocolate chip melting activity. Compare these two curves. Do the melting proportions for the different types of chips appear similar over time? We’ll discuss formal methods for comparing survival curves for the populations of white and milk chocolate chips in Section 9.6.</li>
</ol>
</blockquote>
</div>
<div id="additional-chip-melting-experiences" class="section level2 unnumbered">
<h2>Additional Chip Melting Experiences<a class="anchor" aria-label="anchor" href="#additional-chip-melting-experiences"><i class="fas fa-link"></i></a>
</h2>
<p>In the class data, you observed two possible chip melting <em>experiences</em> over time, corresponding to the milk and white chocolate chips. Figure 9.2 presents four additional Kaplan–Meier curves corresponding to different chip melting experiences.</p>
<p>The Kaplan–Meier curve corresponding to the first scenario, displayed in Part (a), reveals that no chips melt until after the 49th second. Then for any time, say <span class="math inline">\(t\)</span>, between the 49th and the 87th second, the estimated proportion of chocolate chips that remain unmelted decreases somewhat slowly, indicating a possible resistance by the chocolate chips to melt. For the period of time between the 87th and the 96th second, the estimated proportion of chips that remain unmelted decreases rapidly, suggesting that the chocolate chips are very susceptible to melting. For any time beyond the 96th second, the estimated proportion of chips that remain unmelted remains constant at about 20%. This means that there are some chips that have not melted by the end of the observation period (i.e., their melting times are censored); however, note that 20% does not necessarily refer to the proportion of chips with censored melting times.</p>
<p>The Kaplan–Meier curve corresponding to the second melting scenario, displayed in Part (b), shows that chips begin completely melting after 30 seconds, and the proportion of chips that remain unmelted beyond any time between 30 and 65 seconds decreases rapidly, indicating a period of time when the chips are melting quite quickly. The estimated probability that a chip remains unmelted beyond the 65th second is 0, since all chips have melted by this point.</p>
<p>Part (c) displays the Kaplan–Meier curve for the third melting scenario, and we can observe that the chips do not begin completely melting until after 35 seconds. Then during the next 5 seconds, the estimated proportion of chips that remain unmelted declines rapidly (approximately 50% of the chips melt between the 35th and the 40th second). Then for an extended period of time between the 40th and the 85th second, the melting stabilizes, so the proportions of chips that survive are identical. Then melting resumes for the next 15 seconds. For any time beyond the 100th second, it is estimated that about 9% of the chips have not melted.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_2.png" alt="Kaplan-Meier survival curves for different chip melting experiences." width="100%"><p class="caption">
(#fig:fig9.2)Kaplan-Meier survival curves for different chip melting experiences.
</p>
</div>
</div>
<div id="activity-chip-melting-experiences" class="section level2 unnumbered">
<h2>Activity: Chip Melting Experiences<a class="anchor" aria-label="anchor" href="#activity-chip-melting-experiences"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<ol start="20" style="list-style-type: decimal">
<li>Discuss the fourth chip melting scenario, illustrated by the Kaplan–Meier curve in Part (d) of Figure 9.2.</li>
</ol>
</blockquote>
</div>
<div id="descriptive-statistics-for-survival-data" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> <strong>Descriptive Statistics for Survival Data</strong><a class="anchor" aria-label="anchor" href="#descriptive-statistics-for-survival-data"><i class="fas fa-link"></i></a>
</h2>
<p>So far we have focused on using the Kaplan–Meier curve to estimate the proportion of chips that remain unmelted after 25 seconds, after 30 seconds, and so on. While the survival function is useful, we may also be interested in finding an estimate for the <em>mean</em> and <em>median</em> time-to-event for a population of individuals. For example, what is the typical time required for a chocolate chip to melt? Or how long does it take for half of the chips to melt?</p>
<p>It may seem odd that we have spent a great deal of time discussing survival probabilities and their estimates <em>before</em> discussing descriptive statistics. The primary reason for this ordering of topics in survival analysis is that descriptive measures of survival data require the Kaplan–Meier estimated survival probabilities.</p>
<p>It may be tempting to use the same calculations for means and medians that you learned in your previous statistics course. However, consider the mean time until a chocolate chip melts. If we use the sample mean <span class="math inline">\(\bar x\)</span> to estimate this quantity, then once again we run into the same problem as when we estimated chip melting rates—how are censored observations to be treated? For example, if censored observations are treated as complete, then the resulting estimate of the mean melting time will <em>underestimate</em> the true average melting time. We will need to incorporate the Kaplan–Meier estimated survival probabilities to deal with censored observations.</p>
</div>
<div id="estimating-the-mean-survival-time" class="section level2 unnumbered">
<h2>Estimating the Mean Survival Time<a class="anchor" aria-label="anchor" href="#estimating-the-mean-survival-time"><i class="fas fa-link"></i></a>
</h2>
<p>The estimated mean survival time is the total area under the Kaplan–Meier curve. This can be found by adding up the areas of the bars formed by the height of the curve between two adjacent complete survival times, with a slight adjustment if the largest observed event time is censored. Consider the rectangular bars displayed in Figure 9.3. The area of each bar is found by taking the width of each interval <span class="math inline">\(t_{i+1} - t_i\)</span> (the duration of each time period) and multiplying by the estimated probability of surviving through the interval <span class="math inline">\(\hat S(t_i)_{\mathrm{KM}}\)</span> (the height of the bar). If the largest observed event time is censored (i.e., <span class="math inline">\(t_n &gt; t_m\)</span>), then the last interval extends from <span class="math inline">\(t_m\)</span> to <span class="math inline">\(t_n\)</span>. Hence, we have the following expressions for computing the estimated mean survival time:</p>
<p>If the largest observed event time is complete (i.e., <span class="math inline">\(t_n = t_m\)</span>), then the estimator of the mean survival time, denoted by <span class="math inline">\(\hat \mu\)</span>, is given by</p>
<p><span class="math display">\[\begin{align}
\hat \mu
&amp;= \sum_{i=0}^{m-1} \hat S(t_i)_{\mathrm{KM}} \,\bigl(t_{i+1} - t_i\bigr) \notag \\
&amp;= \hat S(t_0)_{\mathrm{KM}}(t_1 - t_0) + \hat S(t_1)_{\mathrm{KM}}(t_2 - t_1) + \dots + \hat S(t_{m-1})_{\mathrm{KM}}(t_m - t_{m-1})
\tag{9.3}
\end{align}\]</span></p>
<p>If the largest event time <span class="math inline">\(t_n\)</span> is censored (i.e., <span class="math inline">\(t_n &gt; t_m\)</span>), then the estimator of the mean survival time is given by</p>
<p><span class="math display">\[\begin{align}
\hat \mu
&amp;= \sum_{i=0}^{m-1} \hat S(t_i)_{\mathrm{KM}} \,(t_{i+1} - t_i) + \hat S(t_m)_{\mathrm{KM}}(t_n - t_m)
\tag{9.4}
\end{align}\]</span></p>
<p>Equations (9.3) and (9.4) can be thought of as a weighted average of the time-to-event data, where the Kaplan–Meier curve <span class="math inline">\(\hat S(t_i)_{\mathrm{KM}}\)</span> acts as weights (probabilities) for the time-to-event intervals. Each term in the summation of Equations (9.3) and (9.4) represents the area of a rectangle formed by the width of the <span class="math inline">\(i\)</span>th time interval <span class="math inline">\(t_{i+1} - t_i\)</span> and the height of the Kaplan–Meier curve <span class="math inline">\(\hat S(t_i)_{\mathrm{KM}}\)</span>. For example, the width of the left-most rectangle in Figure 9.3 outlined by the vertical dotted line is 25 seconds, and the height of the rectangle is 1. So the first term in the sum of Equation (9.3) is <span class="math inline">\(\hat S(t_0)_{\mathrm{KM}}(25 - 0) = (1)(25) = 25\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_3.png" alt="Kaplan-Meier estimated proportions. Vertical lines appear at the complete melting times, and grid marks are overlaid on the graph. The dimension of each square in the grid is 5 seconds (width) by 0.1 (height)." width="100%"><p class="caption">
(#fig:fig9.3)Kaplan-Meier estimated proportions. Vertical lines appear at the complete melting times, and grid marks are overlaid on the graph. The dimension of each square in the grid is 5 seconds (width) by 0.1 (height).
</p>
</div>
<p><br>
The mean survival time is estimated using the time intervals and the Kaplan–Meier estimated probabilities.<br></p>
</div>
<div id="activity-estimated-mean-chip-melting-time" class="section level2 unnumbered">
<h2>Activity: Estimated Mean Chip Melting Time<a class="anchor" aria-label="anchor" href="#activity-estimated-mean-chip-melting-time"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<ol start="21" style="list-style-type: decimal">
<li>Examine Figure 9.3. Visually estimate the mean survival time (i.e., the estimated average time taken for the chocolate chips in the sample to melt) by computing a rough approximation to the area under the Kaplan–Meier curve.<br>
</li>
<li>For the sample of chocolate chip melting times in Table 9.2, which equation, (9.3) or (9.4), is appropriate for estimating the mean survival time of the chips? Based on your answer, calculate the estimated mean using the quantities in Table 9.3.</li>
</ol>
</blockquote>
</div>
<div id="estimating-percentiles-of-the-survival-time-distribution" class="section level2 unnumbered">
<h2>Estimating Percentiles of the Survival Time Distribution<a class="anchor" aria-label="anchor" href="#estimating-percentiles-of-the-survival-time-distribution"><i class="fas fa-link"></i></a>
</h2>
<p>Suppose we want the time at which 50% of the chocolate chips have melted. This quantity is called the median survival time (or, more precisely, the <em>estimated median survival time</em>, since we are working with a sample of survival times). Other times at which a certain percentage of subjects have experienced the event of interest are known as <em>percentiles of the survival time distribution</em>.</p>
<p>The <span class="math inline">\(p\)</span>th percentile of the distribution for the survival time random variable <span class="math inline">\(T\)</span> is defined to be the time by which <span class="math inline">\(p\%\)</span> of the subjects in the population have experienced the target event. The estimate of the <span class="math inline">\(p\)</span>th percentile, denoted by <span class="math inline">\(\hat t_{(p)}\)</span>, is defined to be the smallest <em>complete</em> event time in the sample such that at least <span class="math inline">\(p\%\)</span> of the subjects in the sample have experienced the event of interest before <span class="math inline">\(\hat t_{(p)}\)</span>, and no more than <span class="math inline">\((100 - p)\%\)</span> of the subjects in the sample experience the event after <span class="math inline">\(\hat t_{(p)}\)</span>. Depending on the number of distinct complete event times, the value of <span class="math inline">\(\hat t_{(p)}\)</span> can be found either by inspecting the Kaplan–Meier curve or by finding the solution to the following equation:</p>
<p><span class="math display">\[\begin{align}
\hat t_{(p)} &amp;= \text{smallest complete event time }t_i\text{ in the sample such that } \hat S(t_i)_{\mathrm{KM}} \le 1 - \frac{p}{100}
\tag{9.5}
\end{align}\]</span></p>
<p>For example, to find the estimate for the 70th percentile of the chocolate chip melting times in Figure 9.1, we find the smallest complete event time <span class="math inline">\(t_i\)</span> such that at least 70% of the chips have melted: Since <span class="math inline">\(\hat S(t_i)_{\mathrm{KM}} \le 1 - 0.7 = 0.3\)</span>, we draw a horizontal line at <span class="math inline">\(\hat S(t) = 0.3\)</span>, and eventually we reach the vertical step that occurs at <span class="math inline">\(t_4 = 55\)</span>. Since <span class="math inline">\(t_4 = 55\)</span> is the smallest complete event time that satisfies <span class="math inline">\(\hat S(t_i)_{\mathrm{KM}} \le 0.3\)</span>, <span class="math inline">\(\hat t_{(70)} = 55\)</span>. See Figure 9.4.</p>
<p><br>
Percentile estimates of the survival time distribution are found using the Kaplan–Meier estimated probabilities.<br></p>
</div>
<div id="activity-estimated-median-chip-melting-time" class="section level2 unnumbered">
<h2>Activity: Estimated Median Chip Melting Time<a class="anchor" aria-label="anchor" href="#activity-estimated-median-chip-melting-time"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<ol start="23" style="list-style-type: decimal">
<li>For the chocolate chip melting time data in Table 9.2, calculate the estimated median survival time <span class="math inline">\(\hat t_{(50)}\)</span>. Since right-censored data are typically right skewed, the median survival time is usually preferred to the mean.<br>
</li>
<li>Refer back to the Kaplan–Meier curve displayed in Figure 9.1. The mean and median survival times for the sample of chip melting times are provided in the “Table of Statistics” box on the graph. The interquartile range (IQR) is also provided. Recall that the IQR is the third quartile (75th percentile) minus the first quartile (25th percentile). Verify by hand that the IQR for the sample of times is 25 seconds.<br>
</li>
<li>Use the technology instructions provided on the CD to determine the estimated mean and median survival times separately for the milk and white chocolate chip melting time data from your class activity. Discuss the differences you observe between the two descriptive measures and between the two types of chips.</li>
</ol>
</blockquote>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_4.png" alt="Kaplan-Meier estimated proportions. The horizontal dotted line represents $\hat S(55)_{\mathrm{KM}} = 0.3$ and the vertical dotted line represents $\hat t_{(70)} = t_4 = 55$." width="100%"><p class="caption">
(#fig:fig9.4)Kaplan-Meier estimated proportions. The horizontal dotted line represents <span class="math inline">\(\hat S(55)_{\mathrm{KM}} = 0.3\)</span> and the vertical dotted line represents <span class="math inline">\(\hat t_{(70)} = t_4 = 55\)</span>.
</p>
</div>
<p><br>
Based on the definition of the estimated percentile in Equation (9.5), it is possible that particular estimated percentiles do not exist. The <span class="math inline">\(p\)</span>th percentile will not exist (and your software may return NA) if there does not exist a complete time <span class="math inline">\(t_p\)</span> such that <span class="math inline">\(\hat S(t_p)_{\mathrm{KM}} \le 1 - \tfrac{p}{100}\)</span>. For example, in the MeltingChipsJS data set, more than 25% of the milk chocolate chips had not melted by the end of the study (75 seconds). Thus, there is no estimate of the 75th percentile and the IQR cannot be calculated.
</p>
</div>
<div id="confidence-intervals-for-survival-probabilities" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> <strong>Confidence Intervals for Survival Probabilities</strong><a class="anchor" aria-label="anchor" href="#confidence-intervals-for-survival-probabilities"><i class="fas fa-link"></i></a>
</h2>
<p>Just like any other sample statistic (e.g., the sample mean <span class="math inline">\(\bar x\)</span>), the estimates of the survival probabilities are subject to sampling variability. For example, different samples of chocolate chips (and/or students) would likely lead to different melting times, which would lead to different Kaplan–Meier estimates. Although a point estimate, such as <span class="math inline">\(\hat S(25)_{\mathrm{KM}}\)</span>, is useful for descriptive purposes, we may also want to construct a range of possible values that the estimated survival probability can take—i.e., a range that we can be reasonably sure contains the true survival probability <span class="math inline">\(S(25)\)</span>. In other words, we want to construct a confidence interval for the true survival probability <span class="math inline">\(S(t)\)</span> at time <span class="math inline">\(t = 25\)</span> seconds.</p>
<p>In your first course in statistics, you saw that a confidence interval for a population parameter (e.g., a population mean <span class="math inline">\(\mu\)</span>) has the following form:</p>
<p><span class="math display">\[\begin{align}
\text{point estimate} \;\pm\; \text{critical value}\;\times\;\text{standard error of the estimate}
\tag{9.6}
\end{align}\]</span></p>
<p>where the point estimate is a single estimate of the parameter (such as <span class="math inline">\(\bar x\)</span> for <span class="math inline">\(\mu\)</span>), the critical value is taken from a reference distribution like the standard normal distribution or the <span class="math inline">\(t\)</span>-distribution, and the standard error of the estimate is a measure of the variability in the point estimate. The expression for a confidence interval for <span class="math inline">\(S(t)\)</span> at a fixed time <span class="math inline">\(t\)</span> has a very similar form.</p>
<p>We know that the sampling distribution of <span class="math inline">\(\bar x\)</span> is approximately normal for large sample sizes. A similar result can be stated concerning the sampling distribution of <span class="math inline">\(\hat S(t)_{\mathrm{KM}}\)</span> for fixed <span class="math inline">\(t\)</span>. Some advanced theory tells us that, for larger sample sizes, the sampling distribution of <span class="math inline">\(\hat S(t)_{\mathrm{KM}}\)</span> at a fixed time <span class="math inline">\(t\)</span> is approximately normal. This fact allows us to use critical values from the standard normal distribution.</p>
<p>Using the critical value from a standard normal distribution and the standard error of <span class="math inline">\(\hat S(t)_{\mathrm{KM}}\)</span>, we can put together the confidence interval for <span class="math inline">\(S(t)\)</span> at a fixed time <span class="math inline">\(t\)</span>. The usual procedure is to construct a confidence interval for <span class="math inline">\(S(t)\)</span> at all the complete event times <span class="math inline">\(t_1,\dots,t_m\)</span>.</p>
<p>The 100<span class="math inline">\((1-\alpha)\%\)</span> confidence interval for <span class="math inline">\(S(t)\)</span> at a fixed time <span class="math inline">\(t\)</span> is given by</p>
<p><span class="math display">\[\begin{align}
\hat S(t)_{\mathrm{KM}} \;\pm\; Z_{\alpha/2}\,\mathrm{se}\bigl(\hat S(t)_{\mathrm{KM}}\bigr)
\tag{9.7}
\end{align}\]</span></p>
<p>where <span class="math inline">\(Z_{\alpha/2}\)</span> is the critical value from the standard normal distribution with <span class="math inline">\(\alpha/2\)</span> area under the curve to its right (i.e., corresponding to confidence level <span class="math inline">\(100(1-\alpha)\%\)</span>) and <span class="math inline">\(\mathrm{se}\bigl(\hat S(t)_{\mathrm{KM}}\bigr)\)</span> is the standard error of the Kaplan–Meier estimator at time <span class="math inline">\(t\)</span>, discussed in the following section.</p>
</div>
<div id="the-standard-error-of-the-kaplanmeier-estimator" class="section level2 unnumbered">
<h2>The Standard Error of the Kaplan–Meier Estimator<a class="anchor" aria-label="anchor" href="#the-standard-error-of-the-kaplanmeier-estimator"><i class="fas fa-link"></i></a>
</h2>
<p>The variability in the values of <span class="math inline">\(\hat S(t)_{\mathrm{KM}}\)</span> at a fixed time <span class="math inline">\(t\)</span> in each interval <span class="math inline">\([t_{i-1},\,t_i)\)</span> is measured by the estimated <strong>variance of the Kaplan–Meier estimator</strong>, denoted <span class="math inline">\(\widehat{\mathrm{Var}}\bigl(\hat S(t)_{\mathrm{KM}}\bigr)\)</span> and calculated using the expression</p>
<p><span class="math display">\[\begin{align}
\widehat{\mathrm{Var}}\bigl(\hat S(t)_{\mathrm{KM}}\bigr)
&amp;= \bigl(\hat S(t)_{\mathrm{KM}}\bigr)^2 \;\biggl(\sum_{t_i \le t}\frac{d_i}{n_i(n_i - d_i)}\biggr)
\tag{9.8}
\end{align}\]</span></p>
<p>where <span class="math inline">\(d_i\)</span> is the number of subjects who experienced the event of interest in time interval <span class="math inline">\([t_{i-1},\,t_i)\)</span> and <span class="math inline">\(n_i\)</span> is the number who are at risk at each complete event time <span class="math inline">\(t_i\)</span>.<span class="math inline">\(^3\)</span></p>
<p>The <strong>standard error of the Kaplan–Meier estimator</strong> at time <span class="math inline">\(t\)</span>, denoted by <span class="math inline">\(\mathrm{se}\bigl(\hat S(t)_{\mathrm{KM}}\bigr)\)</span>, is the square root of <span class="math inline">\(\widehat{\mathrm{Var}}\bigl(\hat S(t)_{\mathrm{KM}}\bigr)\)</span>:</p>
<p><span class="math display">\[\begin{align}
\mathrm{se}\bigl(\hat S(t)_{\mathrm{KM}}\bigr)
&amp;= \sqrt{\widehat{\mathrm{Var}}\bigl(\hat S(t)_{\mathrm{KM}}\bigr)}
\tag{9.9}
\end{align}\]</span></p>
<p>As we will see, when we construct the confidence intervals for <span class="math inline">\(S(t)\)</span>, the estimated variance <span class="math inline">\(\widehat{\mathrm{Var}}\bigl(\hat S(t)_{\mathrm{KM}}\bigr)\)</span> [and standard error <span class="math inline">\(\mathrm{se}\bigl(\hat S(t)_{\mathrm{KM}}\bigr)\)</span>] will need to be calculated for each complete event time <span class="math inline">\(t_1,\dots,t_m\)</span>; that is, we need to calculate</p>
<p><span class="math display">\[\begin{align}
\widehat{\mathrm{Var}}\bigl(\hat S(t_1)_{\mathrm{KM}}\bigr),\;\widehat{\mathrm{Var}}\bigl(\hat S(t_2)_{\mathrm{KM}}\bigr),\;\dots,\;\widehat{\mathrm{Var}}\bigl(\hat S(t_m)_{\mathrm{KM}}\bigr).\notag
\end{align}\]</span></p>
<p>For example, the Kaplan–Meier estimated survival probability at the complete time <span class="math inline">\(t=25\)</span> for the data in Table 9.2 is <span class="math inline">\(\hat S(25)_{\mathrm{KM}} = 6/7\)</span>. Using Equation (9.8) and the quantities in Table 9.3, we find that the variance estimate <span class="math inline">\(\widehat{\mathrm{Var}}\bigl(\hat S(25)_{\mathrm{KM}}\bigr)\)</span> at time <span class="math inline">\(t=25\)</span> is given by</p>
<p><span class="math display">\[\begin{align}
\widehat{\mathrm{Var}}\bigl(\hat S(25)_{\mathrm{KM}}\bigr)
&amp;= \bigl(\hat S(25)_{\mathrm{KM}}\bigr)^2 \;\biggl(\sum_{t_i \le 25}\frac{d_i}{n_i(n_i - d_i)}\biggr) \\
&amp;= \Bigl(\tfrac{6}{7}\Bigr)^2 \;\biggl(\frac{0}{7(7-0)} + \frac{1}{7(7-1)}\biggr) \\
&amp;= 0.0175
\notag
\end{align}\]</span></p>
<p>Then the standard error of <span class="math inline">\(\hat S(25)_{\mathrm{KM}}\)</span> at time <span class="math inline">\(t=25\)</span> is <span class="math inline">\(\mathrm{se}\bigl(\hat S(25)_{\mathrm{KM}}\bigr) = \sqrt{0.0175} = 0.1323\)</span>.</p>
<p>With the computed standard error, we can use Formula (9.7) to construct a confidence interval for a survival probability. For example, the 95% confidence interval for <span class="math inline">\(S(25)\)</span>—the probability that a randomly selected milk chocolate chip takes longer than 25 seconds to melt—is calculated as</p>
<p><span class="math display">\[\begin{align}
\hat S(25)_{\mathrm{KM}} \;\pm\; Z_{0.025}\,\mathrm{se}\bigl(\hat S(25)_{\mathrm{KM}}\bigr)
\quad=\quad
\frac{6}{7}\;\pm\;1.96\,(0.1323)
\quad=\quad
(0.60,\;1.12).
\notag
\end{align}\]</span></p>
<p>Observe that the upper limit for the confidence interval for <span class="math inline">\(S(25)\)</span> exceeds 1. Since the confidence interval given by Formula (9.7) is for a <em>survival probability</em>, the interval limits should technically not fall outside the range [0,1]. However, it is possible to obtain a lower limit less than 0 and/or an upper limit greater than 1, especially for smaller sample sizes. This is a drawback of using Formula (9.7) to construct confidence intervals. When confronted with a situation (as is the case here) where the interval limit(s) is (are) outside the range [0,1], it is common practice to truncate the limit(s) at the appropriate minimum value of 0 or maximum value of 1.</p>
<p>The interpretation of confidence interval limits for <em>survival probabilities</em> is similar to the standard interpretation of confidence intervals for other parameters of interest (think back to confidence intervals for a population mean or proportion). For the chip melting times provided in Table 9.2, we can state with 95% confidence that the probability that a chocolate chip will take longer than 25 seconds to melt is between 0.60 and 1.00. Or, equivalently, we are 95% confident that the true proportion of chips that have not melted after 25 seconds is between 60% and 100%.</p>
<p>The Kaplan–Meier curve and associated 95% confidence intervals for the chocolate chip melting time data are displayed in Figure 9.5. Observe the times where the upper limit has been constrained to equal 1 and the lower limit has been constrained to equal 0.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_5.png" alt="Kaplan-Meier curve with 95% confidence intervals. Note that Minitab graphs use the same line type and color for both the Kaplan-Meier curve and the confidence limits; however, the middle line will always be the Kaplan-Meier curve." width="100%"><p class="caption">
(#fig:fig9.5)Kaplan-Meier curve with 95% confidence intervals. Note that Minitab graphs use the same line type and color for both the Kaplan-Meier curve and the confidence limits; however, the middle line will always be the Kaplan-Meier curve.
</p>
</div>
<p><br>
There are alternative formulas for computing confidence intervals for survival probabilities that constrain the limits to lie between 0 and 1, but we’ll leave it to interested readers to investigate them on their own.<br></p>
<p><br>
Confidence intervals provide a range of values that we can be reasonably sure contain the true survival probabilities.<br></p>
</div>
<div id="activity-standard-errors-and-confidence-intervals-for-survival-probabilities" class="section level2 unnumbered">
<h2>Activity: Standard Errors and Confidence Intervals for Survival Probabilities<a class="anchor" aria-label="anchor" href="#activity-standard-errors-and-confidence-intervals-for-survival-probabilities"><i class="fas fa-link"></i></a>
</h2>
<blockquote>
<p>Use the estimated survival probabilities and the entries in Table 9.3 to answer Questions 26 through 28, and use <code>MeltingChips</code> or <code>MeltingChipsJS</code> to answer Questions 29 through 31.<br>
26. Provide a brief explanation of why the estimated variance of <span class="math inline">\(\hat S(0)_{\mathrm{KM}}\)</span>, and hence the standard error of <span class="math inline">\(\hat S(0)_{\mathrm{KM}}\)</span>, is equal to 0.<br>
27. Find the remaining standard errors of <span class="math inline">\(\hat S(t)_{\mathrm{KM}}\)</span> at times <span class="math inline">\(t = 30\)</span>, <span class="math inline">\(t = 45\)</span>, and <span class="math inline">\(t = 55\)</span> for the chocolate chip melting time data.<br>
28. Using your above answers and the appropriate entries in Table 9.3, construct 95% confidence intervals for the survival probabilities <span class="math inline">\(S(t)\)</span> at each of the remaining complete melting times, and interpret their values.<br>
29. Use software to construct the 95% confidence intervals for the survival probabilities for the milk chocolate chip melting time data from your class activity. Graph the Kaplan–Meier curve and the confidence intervals for <span class="math inline">\(S(t)\)</span>.<br>
30. Based on the width of the confidence intervals (upper limit minus lower limit), how useful do you think these intervals are for providing estimates of the true melting times? How could we improve the usefulness of these intervals? (Hint: Refer back to Equation (9.8). What could you change to make the intervals narrower?)<br>
31. On the same graph, plot both Kaplan–Meier estimates and 95% confidence intervals for the white and milk chocolate chip melting time data from your class activity. Explain whether or not the two types of chocolate appear to have different survival functions.</p>
</blockquote>
<p><br>
The confidence interval for <span class="math inline">\(S(t)\)</span> is valid for a single fixed time at which the inference is to be made. For this reason, confidence intervals are sometimes referred to as <em>pointwise intervals</em>. Each interval constructed using Formula (9.7) is relevant only for <span class="math inline">\(t\)</span> within the <span class="math inline">\(i\)</span>th interval. Therefore, it is not correct to state that we are 95% confident that the entire true survival curve <span class="math inline">\(S(t)\)</span> falls between the confidence bands in Figure 9.5. If we want a confidence band for an entire survival function <span class="math inline">\(S(t)\)</span> within which we can guarantee with a specified level of confidence that the entire curve falls, alternative confidence bands need to be computed.<br></p>
</div>
<div id="comparing-survival-functions" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> <strong>Comparing Survival Functions</strong><a class="anchor" aria-label="anchor" href="#comparing-survival-functions"><i class="fas fa-link"></i></a>
</h2>
<p>In Question 19 you were asked to comment on the differences in melting experiences between white and milk chocolate chips. Now we will look at how to formally compare the survival experiences of two or more groups. This is equivalent to investigating whether survival experience depends on another (categorical) variable of interest. To compare the survival experiences of milk and white chocolate chips, we will ask, “Does melting experience depend on the type of chip?”</p>
<p>To illustrate the comparison techniques, we’ll use a sample of <em>white</em> chocolate chip melting times for 9 other students:</p>
<p><span class="math display">\[\begin{align}
\text{45+ 35 48 64+ 72 42 55+ 43 62}
\notag
\end{align}\]</span></p>
<p>First, we visually inspect the Kaplan–Meier curves for both groups. Figure 9.6 shows that the Kaplan–Meier curve for the white chocolate chip melting times tends to be above the milk chocolate chip curve. This means that, over time, the proportion of unmelted white chocolate chips is generally larger than the proportion of unmelted milk chocolate chips; that is, white chocolate chips generally take longer to melt than milk chocolate chips. While Figure 9.6 appears to show a difference in the curves based on our sample data, a formal hypothesis test is needed to determine if the difference in the <em>sample data</em> is large enough to conclude that the survival curves for the <em>populations</em> of white and milk chocolate chips are different.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_6.png" alt="Kaplan-Meier curves for the hypothetical melting times of milk and white chocolate chips." width="100%"><p class="caption">
(#fig:fig9.6)Kaplan-Meier curves for the hypothetical melting times of milk and white chocolate chips.
</p>
</div>
</div>
<div id="the-log-rank-test" class="section level2 unnumbered">
<h2>The Log-Rank Test<a class="anchor" aria-label="anchor" href="#the-log-rank-test"><i class="fas fa-link"></i></a>
</h2>
<p>The log-rank test is a formal statistical inference procedure used to determine if the population survival curves are significantly different over the range of time <span class="math inline">\(t\)</span>—that is, to determine if the survival experiences significantly differ. The null hypothesis is that the survival experiences of both populations are equal—that is, <span class="math inline">\(H_0:\;S_1(t) = S_2(t)\)</span> for all times t during which at least one of the groups has at least one subject at risk of
experiencing the event. The alternative hypothesis is that the survival experiences are not identical for at least one value of <span class="math inline">\(t\)</span> (i.e., <span class="math inline">\(H_a:\;S_1(t)\neq S_2(t)\)</span> for some <span class="math inline">\(t\)</span>).</p>
<p>Assuming that we have two independent populations and that the survival experiences for group 1 and group 2 are identical, the log-rank test compares the total number of <em>observed</em> events to the total number of <em>expected</em> events in group 1. Observed counts that disagree significantly with the expected counts lead to rejection of the null hypothesis that the survival experiences are identical.</p>
<p>Table 9.4 contains the melting data for both the milk and the white chocolate chips. To calculate the log-rank test statistic, define the following terms:</p>
<ul>
<li>
<span class="math inline">\(m\)</span>: the number of distinct ordered complete event times <span class="math inline">\(t_1, t_2, \dots, t_m\)</span> for both groups combined (we will not consider <span class="math inline">\(t_0 = 0\)</span>).</li>
<li>
<span class="math inline">\(n_{1i}\)</span>: the number of subjects at risk of experiencing the event at time <span class="math inline">\(t_i\)</span> in group 1, for <span class="math inline">\(i = 1,\dots,m\)</span>.<br>
</li>
<li>
<span class="math inline">\(n_{2i}\)</span>: the number of subjects at risk of experiencing the event at time <span class="math inline">\(t_i\)</span> in group 2.<br>
</li>
<li>
<span class="math inline">\(n_i = n_{1i} + n_{2i}\)</span>: the total number of individuals in both groups at risk at time <span class="math inline">\(t_i\)</span>.<br>
</li>
<li>
<span class="math inline">\(d_{1i},\,d_{2i},\,d_i\)</span>: the observed number of event occurrences at each of the complete event times for group 1, group 2, and the combined groups, respectively.</li>
</ul>
<p>The partially completed Table 9.5 contains the appropriate quantities to compute the log-rank test statistic. The total number of complete event times for both types of chips is <span class="math inline">\(m = 10\)</span>. All 16 milk and white chocolate chips were at risk of melting prior to the beginning of the first time interval <span class="math inline">\([25,30]\)</span>, so <span class="math inline">\(n_{11} = 7\)</span>, <span class="math inline">\(n_{21} = 9\)</span>, and <span class="math inline">\(n_1 = 16\)</span>. Since 1 milk chocolate chip melted in the first time interval <span class="math inline">\([25,30]\)</span> and no white chocolate chips melted in that interval, <span class="math inline">\(d_{11} = 1\)</span>, <span class="math inline">\(d_{21} = 0\)</span>, and <span class="math inline">\(d_1 = 1\)</span>.</p>
<p>The expected number of event occurrences in group 1 at time <span class="math inline">\(t_i\)</span>, denoted <span class="math inline">\(E_{1i}\)</span>, is given by</p>
<p><span class="math display">\[\begin{align}
E_{1i} &amp;= \frac{n_{1i}\,d_i}{n_i}
\tag{9.10}
\end{align}\]</span></p>
<p>The quantity <span class="math inline">\(d_i/n_i\)</span> is the overall proportion of individuals at time <span class="math inline">\(t_i\)</span> who experience the event, and <span class="math inline">\(n_{1i}\)</span> is the
number of individuals in group 1 who are at risk at time <span class="math inline">\(t_i\)</span>.</p>
<p><br>
Equation (9.10) is based on the assumption that the number of occurrences for group 1 at time <span class="math inline">\(t_i\)</span> follows a hypergeometric distribution.<span class="math inline">\(^6\)</span>
</p>
<p>Next, we need to compare the observed and expected counts at time <span class="math inline">\(t_i\)</span>, which can be done by taking the
difference between the counts and dividing by an appropriate scaling factor. This scaling quantity is the vari-
ance of the number of event occurrences at time ti. Again, based on the assumption that the number of event
occurrences at time <span class="math inline">\(t_i\)</span> for group 1 follows a hypergeometric distribution, the variance for the number of event
occurrences for group 1 at time <span class="math inline">\(t_i\)</span>, denoted <span class="math inline">\(V_{1i}\)</span>, is given by</p>
<p><span class="math display">\[\begin{align}
V_{1i} &amp;= \frac{n_{1i}\,n_{2i}\,d_i\,(n_i - d_i)}{n_i^2\,(n_i - 1)}
\notag
\end{align}\]</span></p>
</div>
<div id="activity-calculating-the-expected-number-and-variance-of-melted-chips" class="section level2 unnumbered">
<h2>Activity: Calculating the Expected Number and Variance of Melted Chips<a class="anchor" aria-label="anchor" href="#activity-calculating-the-expected-number-and-variance-of-melted-chips"><i class="fas fa-link"></i></a>
</h2>
<p>Refer to the entries in Table 9.5.<br>
32. Show that the expected number of melted milk chocolate chips in the first interval is 7/16 = 0.4375.
33. Show that the variance in the first interval is 0.246.</p>
<p>Table 9.5 contains values of <span class="math inline">\(E_{1i}\)</span> and <span class="math inline">\(V_{1i}\)</span> for the first six time intervals for the milk chocolate chip and white chocolate chip melting time data. Remember that we need to compare the total observed and total expected counts over all the complete event times, so we compare <span class="math inline">\(\sum_{i=1}^m d_{1i}\)</span>, and the sum of the expected event occurrences, <span class="math inline">\(\sum_{i=1}^m E_{1i}\)</span>, over all <span class="math inline">\(m\)</span> complete event times. We put this together to obtain the statistic</p>
<p><span class="math display">\[\begin{align}
\chi &amp;= \frac{\sum_{i=1}^m d_{1i} - \sum_{i=1}^m E_{1i}}{\sqrt{\sum_{i=1}^m V_{1i}}}
\tag{9.11}
\end{align}\]</span></p>
<p>where <span class="math inline">\(\sum_{i=1}^m V_{1i}\)</span> is the variance of the total number of event occurrences over the <span class="math inline">\(m\)</span> complete event times. Basically, Equation (9.11) is nothing more than a <span class="math inline">\(z\)</span>-score; i.e., it tells us how many standard deviations the total observed number of event occurrences is above or below its mean.</p>
<p>Although we can use Equation (9.11) to make our decision regarding the null hypothesis of equal survival functions, it is more common to see the square of the statistic in Equation (9.11) reported in statistical software output. The square of the statistic in Equation (9.11), called the log-rank test statistic (for two groups), is given by</p>
<p><span class="math display">\[\begin{align}
\chi^2 &amp;= \frac{\bigl(\text{total observed events in group 1} - \text{total expected events in group 1}\bigr)^{2}}%
             {\text{variance in the total number of all complete events}} \notag \\
       &amp;= \frac{\left(\sum_{i=1}^m d_{1i} - \sum_{i=1}^m E_{1i}\right)^{2}}{\sum_{i=1}^m V_{1i}}
\tag{9.12}
\end{align}\]</span></p>
<p>If the sample size is reasonably large, then under the assumption that the two survival curves are identical, <span class="math inline">\(\chi^2\)</span> approximately follows a chi-square distribution with 1 degree of freedom. If the observed and expected numbers of events are far apart, the test statistic will correspond to a small <span class="math inline">\(p\)</span>-value; thus, we will reject <span class="math inline">\(H_0: S_1(t) = S_2(t)\)</span> and conclude that the two population survival functions are different.</p>
<p><br>
The test statistic <span class="math inline">\(\chi^2\)</span> is said to <em>asymptotically</em> follow a chi-square distribution, which means that as the total sample size approaches infinity, the distribution of the statistic will closely follow the chi-square distribution with 1 degree of freedom. Unfortunately, there is no generally accepted rule as to what constitutes a large sample size; however, simulation studies have shown that even for small sample sizes (10 per group), the statistic will be approximately chi-square if the amount of censoring is roughly the same in each group.<span class="math inline">\(^7\)</span>
</p>
</div>
<div id="activity-log-rank-test-statistic" class="section level2 unnumbered">
<h2>Activity: Log-Rank Test Statistic<a class="anchor" aria-label="anchor" href="#activity-log-rank-test-statistic"><i class="fas fa-link"></i></a>
</h2>
<ol start="34" style="list-style-type: decimal">
<li>Calculate the missing quantities in Table 9.5. Note that <span class="math inline">\(E_{19}\)</span>, <span class="math inline">\(E_{1,10}\)</span>, <span class="math inline">\(V_{19}\)</span>, and <span class="math inline">\(V_{1,10}\)</span> are all equal to 0. This is because all the milk chocolate chips have melted by 62 seconds.<br>
</li>
<li>Use Equation (9.12) and the entries in Table 9.5 to verify that the value of the log-rank test statistic is 1.007. Note that your answer may vary slightly because of rounding.</li>
</ol>
<p>The <span class="math inline">\(p\)</span>-value corresponding to the value of <span class="math inline">\(\chi^2\)</span> is 0.316. Hence, we do not have strong enough evidence to conclude that the melting experiences (survival curves) of the populations of white and milk chocolate chips significantly differ. Note that we should be cautious about interpreting the results of this test because the sample size of 16 is fairly small. We should always supplement the results of the test with graphs of the Kaplan–Meier curves.</p>
<p>If the difference between the total observed and expected number of event occurrences is large, then the
test statistic is much greater than 0 and the resulting p-value will be small. Then the null hypothesis will be
rejected</p>
</div>
<div id="activity-log-rank-test-for-chip-melting-activity" class="section level2 unnumbered">
<h2>Activity: Log-Rank Test for Chip Melting Activity<a class="anchor" aria-label="anchor" href="#activity-log-rank-test-for-chip-melting-activity"><i class="fas fa-link"></i></a>
</h2>
<ol start="36" style="list-style-type: decimal">
<li>Use software to conduct the log-rank test to determine if the melting experiences for the white and milk chocolate chips in your chip melting activity are different. What do you conclude about the survival experiences for the two types of chips?</li>
</ol>
</div>
<div id="the-wilcoxon-test" class="section level2 unnumbered">
<h2>The Wilcoxon Test<a class="anchor" aria-label="anchor" href="#the-wilcoxon-test"><i class="fas fa-link"></i></a>
</h2>
<p>Another test for comparing survival curves, commonly used in practice and reported in software output, is the <strong>Wilcoxon test</strong>. The Wilcoxon test is similar to the log-rank test in the sense that it also compares the observed and expected number of event occurrences; however, the Wilcoxon test statistic is a slight variant of the log-rank test statistic. It places more weight on differences in the survival curves at earlier times (when the number at risk will be larger), so it can be better at detecting differences in the survival curves at earlier time periods. Note that when survival curves cross, neither test may be able to detect a significant difference in survival experiences. This underscores the importance of graphing the survival curves and describing the survival experiences based on observation.</p>
<p>Although the results of the log-rank and Wilcoxon tests will typically agree, it is possible for the two tests to yield different results. In practice, when the tests yield different results, you should report the results of both tests. When the tests yield similar conclusions, results of either test can be provided.<span class="math inline">\(^8\)</span></p>
<p>The log-rank test and the Wilcoxon test can be implemented with many statistical packages. For the chip melting data in Table 9.4, the results for the tests comparing survival curves are shown in Figure 9.7.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_7.png" alt="Software output for the log-rank and Wilcoxon tests." width="100%"><p class="caption">
(#fig:fig9.7)Software output for the log-rank and Wilcoxon tests.
</p>
</div>
<p>Observe that the results of the two different tests are in agreement. Thus, even though the two curves
based on the sample data look fairly different, we do not have enough evidence to conclude that the popula-
tion survival functions for white and milk chocolate chips are different.</p>
<p><br>
The log-rank and Wilcoxon tests provide formal inferential methods for comparing the survival experiences of two or more groups.<br></p>
<p><br>
The log-rank (and Wilcoxon) test can easily be applied to more than two groups. Although the details are not given here, the test statistic follows a chi-square distribution with <span class="math inline">\(k - 1\)</span> degrees of freedom, where <span class="math inline">\(k =\)</span> number of groups.<span class="math inline">\(^9\)</span>
</p>
</div>
<div id="beyond-different-survival-experiences-regression-models-for-survival-data" class="section level2 unnumbered">
<h2>Beyond Different Survival Experiences: Regression Models for Survival Data<a class="anchor" aria-label="anchor" href="#beyond-different-survival-experiences-regression-models-for-survival-data"><i class="fas fa-link"></i></a>
</h2>
<p>The log-rank and Wilcoxon tests are useful procedures for determining whether the survival experiences of two or more independent groups are different. This is basically equivalent to testing whether there is a significant effect of a categorical explanatory variable on survival. However, the tests do not allow us to determine the extent to which the survival experiences differ or, equivalently, to estimate the effects of the categorical explanatory variables on survival. Furthermore, the tests cannot be used to appropriately assess the effects of quantitative variables on survival. Consider the chocolate chip activity, and suppose we had additional information on the age of the chip. Are older chips likely to melt earlier than newer chips? Can we predict how long a chip that is a month old will take to melt? How do we incorporate censored melting times? These are questions that need to be addressed using regression-type models that exploit the relationship between the survival time random variable, <span class="math inline">\(T\)</span>, and the explanatory variables of interest.</p>
<p>Regression models for survival data will not be discussed in this chapter; however, we will briefly mention two main approaches: regression models that explicitly model the log of the survival time variable, <span class="math inline">\(T\)</span>, as a function of the explanatory variables, sometimes referred to as <strong>parametric regression models</strong> or <strong>accelerated failure time models</strong>, and those that model the hazard function (to be discussed) as a function of the explanatory variables, known in the literature as the <strong>proportional hazards model</strong> or the <strong>Cox regression model</strong>.<span class="math inline">\(^10\)</span></p>
</div>
<div id="what-can-we-conclude-about-melting-chocolate-chips" class="section level2" number="8.7">
<h2>
<span class="header-section-number">8.7</span> <strong>What Can We Conclude About Melting Chocolate Chips?</strong><a class="anchor" aria-label="anchor" href="#what-can-we-conclude-about-melting-chocolate-chips"><i class="fas fa-link"></i></a>
</h2>
<p>The goal in the previous sections and activities was to motivate introductory topics in survival analysis by conducting a simple experiment with chocolate chip melting times. As we have seen, the Kaplan–Meier estimator of the survival function forms the basis of several quantities used to summarize and investigate chip melting times, including descriptive measures like the mean and median.</p>
<p>We were also able to compare the melting experiences of white and milk chocolate chips using the log-rank test. Since the chip melting activity was an experimental study (students were randomly assigned to white or milk chocolate chips), if the result of the log-rank test is significant, then we can conclude that the type of chip affects the melting time (i.e., that type of chip causes differences in the melting experiences).</p>
<p>Note that the group sizes (i.e., the numbers of white and milk chocolate chips) could be small (depending on the number of students participating in the activity), and we need to be cautious about interpreting the results of the log-rank test if this is the case.</p>
<p>Although simple in scope, the chip melting time data you collected have the same general features as other survival data that will be introduced in the extended activities and that are of more practical importance and interest to researchers in various fields. Real studies that implement survival analysis methods are common in medicine, health, and the social sciences, and in the remainder of this chapter we will use data from real surveys and studies to see how survival analysis methods can be applied in a variety of disciplines.</p>
</div>
<div id="a-closer-look-survival-analysis" class="section level2 unnumbered">
<h2>
<em>A Closer Look: Survival Analysis</em><a class="anchor" aria-label="anchor" href="#a-closer-look-survival-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>The remaining sections and extended activities introduce additional methods for analyzing survival data and
additional types of incomplete data. Although the Kaplan-Meier estimator is useful for examining the propor-
tion of individuals yet to experience the target event at a specific moment in time, it does not assess the risk,
or potential, at that particular moment that an individual who has not previously done so will experience
the target event. Risk can be addressed using the hazard function and the closely related cumulative hazard
function, which will be discussed in the following sections. In the final section of this chapter, we’ll introduce
some other types of incomplete survival data, including left- and interval-censored data and truncated data</p>
</div>
<div id="the-hazard-function" class="section level2" number="8.8">
<h2>
<span class="header-section-number">8.8</span> <strong>The Hazard Function</strong><a class="anchor" aria-label="anchor" href="#the-hazard-function"><i class="fas fa-link"></i></a>
</h2>
<p>Recall the chip melting experiment, and suppose that 45 seconds have passed. Among the chips that have not melted (have survived), at what rate will the chips melt (fail) in the next 5 seconds? In the next second? In the next instant of time? Would this rate be the same for chips that have not melted after 60 seconds? These types of questions address when individuals (or chips, in this example) are likely to experience the target event, given that they have not previously experienced the event. To answer such questions, we will need to use another function of survival time called the hazard function, denoted <span class="math inline">\(h(t)\)</span>.</p>
<p>In survival analysis, the (conditional) risk of experiencing the target event is associated with the rate at which individuals who have survived up to a particular time will experience failure at that moment. Earlier, when we discussed the construction of the Kaplan–Meier estimator, we introduced the risk set of individuals. The individuals in the risk set have survived (not experienced the event) up through time <span class="math inline">\(t_{i-1}\)</span> and are available to experience the target event in the time interval <span class="math inline">\([t_{i-1},\,t_i)\)</span> for <span class="math inline">\(i = 2, \dots, m\)</span>. So anybody in the risk set at time <span class="math inline">\(t_{i-1}\)</span> runs the risk of experiencing, or has the potential to experience, the target event in the next interval of time.</p>
<p>As the unit of time becomes finer and finer, until we are looking for a rate of failure in the next <em>instant</em> of time, we approach a quantity known as the hazard rate or conditional failure rate. The hazard rate at time <span class="math inline">\(t\)</span>, also known as the (population) hazard function, denoted <span class="math inline">\(h(t)\)</span>, is defined as the <em>instantaneous</em> rate of failure at time <span class="math inline">\(t\)</span> for all subjects in the population who have survived until time <span class="math inline">\(t\)</span>.</p>
<p>The formal definition of the population hazard function requires the use of calculus. Those of you who have the necessary background and wish to do so may read about <span class="math inline">\(h(t)\)</span> in more detail in the next section. Otherwise, you can skim or skip the next section. At this point it is enough to understand that the hazard function (population or estimated) is used to describe when subjects are likely to experience the event of interest and can help us identify periods of high and low risk of event occurrence.</p>
<p><br>
If the notion of an “instantaneous” rate troubles you, imagine the situation when you are driving your car and you glance down at the speedometer to see how fast you are traveling. If the speedometer reads 65 miles per hour at the instant you glance at it, this is the instantaneous rate at which you are traveling in distance per hour.<br></p>
<div id="the-population-hazard-function" class="section level3 unnumbered">
<h3>The Population Hazard Function*<a class="anchor" aria-label="anchor" href="#the-population-hazard-function"><i class="fas fa-link"></i></a>
</h3>
<p>To reiterate, the population hazard function, <span class="math inline">\(h(t)\)</span>, is the rate at which individuals in the population experience the target event in the next <em>instant</em> of time (time <span class="math inline">\(t\)</span>), conditional on having survived (not experienced the event) up to time <span class="math inline">\(t\)</span>. Although you are probably comfortable with the idea of a small interval of time like one second or even a tenth of a second, it may be a bit harder to imagine an interval of time that lasts an instant. In calculus, an instant of time is regarded as an interval of time whose width approaches (but never reaches) 0. The hazard function, <span class="math inline">\(h(t)\)</span>, is defined as</p>
<p><span class="math display">\[\begin{align}
h(t) &amp;= \lim_{\Delta t \to 0} \frac{P\bigl(t \le T &lt; t + \Delta t \mid T \ge t\bigr)}{\Delta t}
\tag{9.13}
\end{align}\]</span></p>
<p>where <span class="math inline">\(\Delta t\)</span> indicates a small change in time <span class="math inline">\(t\)</span>.</p>
<p>From this expression, we see that the hazard is the conditional probability of experiencing the event per unit of time <span class="math inline">\(\Delta t\)</span>. Note that since <span class="math inline">\(h(t)\)</span> is a rate, it may take on values greater than 1. The only restriction on the hazard function is that <span class="math inline">\(h(t) \ge 0\)</span>.</p>
<p>In some situations, a graph of <span class="math inline">\(h(t)\)</span> can be constructed and examined for periods of high and low risk; however, an expression for <span class="math inline">\(h(t)\)</span> requires an assumption about the probability distribution of the time-to-event random variable <span class="math inline">\(T\)</span> (as well as some calculus and knowledge of intermediate concepts in mathematical statistics). In fields such as engineering, a distribution for <span class="math inline">\(T\)</span> may be assumed, where, for example, <span class="math inline">\(T\)</span> might be defined as the time until a computer processing chip fails, and then graphs of <span class="math inline">\(h(t)\)</span> [as well as <span class="math inline">\(S(t)\)</span>] can be constructed.</p>
<p>Although we will not provide any computational examples of <span class="math inline">\(h(t)\)</span>, we’ll provide two hypothetical hazard curves and describe them in the context of melting chocolate chips.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Calculus is suggested for this section&lt;/p&gt;"><sup>6</sup></a> Figure 9.8 displays two hazard functions that are used in practice when simplifying assumptions about the data can be made. The hazard function in Part (a) illustrates constant risk, while the hazard function in Part (b) illustrates increasing risk. Part (a) displays a situation or study where the subjects have a constant risk of experiencing the target event. In the context of melting chips, the constant hazard rate of 0.40 (i.e., <span class="math inline">\(h(t)=0.4\)</span>) shown in Part (a) would correspond to a period throughout which events (melting chips) occur with equal frequency during any equal period of time. Now examine Part (b). The hazard function is increasing over time; furthermore, the hazard rate is linearly related to time. This implies that the risk of chips melting increases as a function of time, corresponding to a period of time during which the proportion of unmelted chips is decreasing.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_8.png" alt="Possible forms of the population hazard function." width="100%"><p class="caption">
(#fig:fig9.8)Possible forms of the population hazard function.
</p>
</div>
<p>Equation (9.13) may look something like the formal definition of the derivative of some function (although it probably isn’t clear what that function is). It turns out that <span class="math inline">\(h(t)\)</span> is related to the derivative of a function of the (population) survival function <span class="math inline">\(S(t)\)</span> by the expression</p>
<p><span class="math display">\[\begin{align}
h(t) &amp;= -\frac{d}{dt}\,\ln\bigl[S(t)\bigr]
\tag{9.14}
\end{align}\]</span></p>
<p>That is, the hazard function is equal to the negative of the derivative of the natural logarithm of the survival function. This identity is not very obvious, and we skip the mathematical details here. The important thing to note is that since <span class="math inline">\(S(t)\)</span> is a function based on the distribution of the time-to-event random variable <span class="math inline">\(T\)</span>, <span class="math inline">\(h(t)\)</span> is also a function based on the distribution of <span class="math inline">\(T\)</span>. Hence, if we know the exact distribution of <span class="math inline">\(T\)</span>, we can calculate the hazard function using calculus.</p>
<p>
The population hazard function describes how the conditional risk of experiencing the event changes over time for individuals in the population.<br></p>
</div>
</div>
<div id="the-estimated-hazard-function" class="section level2 unnumbered">
<h2>The Estimated Hazard Function<a class="anchor" aria-label="anchor" href="#the-estimated-hazard-function"><i class="fas fa-link"></i></a>
</h2>
<p><br>
The R statistical package is suggested for calculating and graphing the estimated hazard and estimated cumulative hazard functions discussed in this section and Section 9.9.<br></p>
<p>We are not likely to know the true hazard rate at any particular moment in time unless we can make some assumption about the time-to-event variable <span class="math inline">\(T\)</span>. Typically we have only observed event times that can be used to estimate the true hazard rates. Whereas the population hazard function, <span class="math inline">\(h(t)\)</span>, is the rate at which individuals in the population experience the target event in the next <em>instant</em> of time (time <span class="math inline">\(t\)</span>), conditional on surviving to time <span class="math inline">\(t\)</span>, the estimated hazard function assesses the conditional failure rate during the <span class="math inline">\(i\)</span>th interval of time <span class="math inline">\([t_i,\,t_{i+1})\)</span> for those individuals in the sample who have survived to time <span class="math inline">\(t_i\)</span>.</p>
<p>The estimates of hazard are based on quantities used to find the Kaplan–Meier estimated probabilities, so we will first construct time intervals <span class="math inline">\([t_i,\,t_{i+1})\)</span> for <span class="math inline">\(i = 1,\dots,m-1\)</span> as if we were constructing the Kaplan–Meier estimator, where <span class="math inline">\(t_0 = 0\)</span> and <span class="math inline">\(m\)</span> is the number of complete event times (see Section 9.3 for details).</p>
<p>Recall that the estimated conditional probability of experiencing the target event in the <span class="math inline">\(i\)</span>th interval <span class="math inline">\([t_i,\,t_{i+1})\)</span> is given by</p>
<p><span class="math display">\[\begin{align}
\hat p_i &amp;= \frac{d_i}{n_i}
\notag
\end{align}\]</span></p>
<p>for <span class="math inline">\(i=0,1,\dots,m-1\)</span>. Recall that <span class="math inline">\(\hat p_i\)</span> represents the proportion of remaining subjects in the sample at the beginning of the <span class="math inline">\(i\)</span>th interval who experience the target event in the time interval <span class="math inline">\([t_i,\,t_{i+1})\)</span>.</p>
<p>If we divide <span class="math inline">\(\hat p_i = d_i/n_i\)</span> by the width of the time interval <span class="math inline">\(t_{i+1}-t_i\)</span>, then the resulting quantity</p>
<p><span class="math display">\[\begin{align}
\frac{\hat p_i}{t_{i+1} - t_i}
\tag{9.15}
\end{align}\]</span></p>
<p>yields the <em>average</em> conditional probability of event occurrence per unit of time within <span class="math inline">\([t_i,\,t_{i+1})\)</span>. This quantity is the <strong>estimated hazard rate</strong> or <strong>estimated hazard function</strong> for <span class="math inline">\(t_i \le t &lt; t_{i+1}\)</span>, denoted by <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span>, and measures the estimated conditional probability of experiencing the event <em>per</em> unit of time in <span class="math inline">\([t_i,\,t_{i+1})\)</span>. When no interval of time is specified, <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> will be used to refer to the estimated hazard function for any <span class="math inline">\(t\)</span> within the entire observed range of time.</p>
<p>Table 9.3 contained the observed number of melted chips, number of chips at risk, and so on, for the chip melting times. In Table 9.4, columns containing the width of each interval of time <span class="math inline">\(t_{i+1} - t_i\)</span>, and the estimated hazard rate <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> for each time interval have been appended, and values have been computed for the first three rows. We interpret the estimated hazard rates <span class="math inline">\(\hat h(t)_{\mathrm{KM}} = 0\)</span> for <span class="math inline">\(t_0 \le t &lt; t_1\)</span>, <span class="math inline">\(\hat h(t)_{\mathrm{KM}} = 0.0286\)</span> for <span class="math inline">\(t_1 \le t &lt; t_2\)</span>, and <span class="math inline">\(\hat h(t)_{\mathrm{KM}} = 0.0111\)</span> for <span class="math inline">\(t_2 \le t &lt; t_3\)</span> in the following manner: Since no chips melt within the time interval <span class="math inline">\([0,25)\)</span>, 0% of the unmelted chips melt per second during that interval. Within the time interval <span class="math inline">\([25,30)\)</span>, we estimate that, of the chips that have not yet melted after 25 seconds, about 2.9% will melt per second. The estimated hazard rate is not defined for the last interval <span class="math inline">\([55,60)\)</span>, since the width of the last interval cannot be determined because 60+ is a censored melting time.</p>
</div>
<div id="extended-activity-chip-melting-hazard-rates" class="section level2 unnumbered">
<h2>Extended Activity: Chip Melting Hazard Rates<a class="anchor" aria-label="anchor" href="#extended-activity-chip-melting-hazard-rates"><i class="fas fa-link"></i></a>
</h2>
<ol start="37" style="list-style-type: decimal">
<li>Compute the missing entries in Table 9.6.<br>
</li>
<li>Among chips that have not yet melted after 30 seconds, estimate the rate at which the chips will melt in the next 15 seconds.<br>
</li>
<li>Excluding the first time interval, during which period (interval) of time are chips at their highest risk of melting? Lowest risk?<br>
</li>
<li>Do the values of <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> suggest that the estimated hazard function is a strictly increasing or strictly decreasing function, or do they suggest that the function can increase and decrease over time?</li>
</ol>
<p>We can plot the estimated hazard rates versus time to view the estimated <strong>hazard curve</strong> for the sample of survival times. The Kaplan–Meier curve and estimated hazard function for the chocolate chip melting times are shown in Figure 9.9. Note that, because of the small sample size, the plot is extremely rough and the pattern is somewhat erratic. This curve is an approximation to the corresponding true hazard function for the population of all chocolate chip melting times. From Figure 9.9 we observe that the lowest risk of melting occurs between 30 and 45 seconds (among chips that have remain unmelted up through 30 seconds). The highest risk of melting occurs between the 45th and the 55th second. Note that the estimated hazard rate is not defined before the first complete event time and after the last complete time.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_9.png" alt="Estimated survival probabilities and estimated hazard rates for the chocolate chip data." width="100%"><p class="caption">
(#fig:fig9.9)Estimated survival probabilities and estimated hazard rates for the chocolate chip data.
</p>
</div>
</div>
<div id="extended-activity-estimated-hazard-rates" class="section level2 unnumbered">
<h2>Extended Activity: Estimated Hazard Rates<a class="anchor" aria-label="anchor" href="#extended-activity-estimated-hazard-rates"><i class="fas fa-link"></i></a>
</h2>
<p>Examine Figure 9.9, the entries in Table 9.6, and Formula (9.15) to address the following questions:<br>
41. In general, can <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> take on a negative value in any time interval? Briefly explain. What does this suggest about the minimum value of <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span>?<br>
42. Is there a maximum value that <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> can take on within a (finite) interval of time? Briefly explain.</p>
<p>Note some additional features of the estimated hazard function:</p>
<ul>
<li>The estimated hazard curve extends only to the last complete event time, <span class="math inline">\(t_m\)</span>; that is, if the last time interval is of the form <span class="math inline">\([t_m, t_n)\)</span>, where the largest observed event time, <span class="math inline">\(t_n\)</span>, is censored, then no hazard rate is defined during that interval. The reason is that the width of this last interval cannot be determined. In this respect the estimated hazard curve is unlike the Kaplan–Meier curve, which would extend to the largest observed event time if it were censored.<br>
</li>
<li>The estimated hazard curve <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> will typically have an erratic pattern, especially when the number of event times is large. It can be difficult to provide a general summary of the hazard rate over time.</li>
</ul>
</div>
<div id="age-at-first-alcoholic-drink" class="section level2 unnumbered">
<h2>Age at First Alcoholic Drink<a class="anchor" aria-label="anchor" href="#age-at-first-alcoholic-drink"><i class="fas fa-link"></i></a>
</h2>
<p>When do individuals have their first drink of alcohol? The legal age for consuming alcohol is 21 years, but some individuals claim to have had their first alcoholic drink when they were as young as 1 year old! We can investigate the age at which individuals had their first drink of alcohol using data from the National Comorbidity Survey of 1990–1992. Participants were asked to recall the age at which they had their first drink of alcohol. Those who could recall the age at which they had their first drink had complete event times (i.e., the age at which they had their first drink). Individuals who had not had a drink by the time of the interview had a right-censored event time (their age at the time of the interview). Individuals who could not recall the age at which they had their first drink were not included in the sample.</p>
</div>
<div id="extended-activity-age-at-first-alcoholic-drink" class="section level2 unnumbered">
<h2>Extended Activity: Age at First Alcoholic Drink<a class="anchor" aria-label="anchor" href="#extended-activity-age-at-first-alcoholic-drink"><i class="fas fa-link"></i></a>
</h2>
<p>Data set: <span class="math inline">\(Firstdrink\)</span><br>
43. Investigate the time until first drink by creating a Kaplan–Meier curve (with a confidence interval) for the data. What do you observe about the survival probabilities?<br>
44. Use the software instructions provided to plot the estimated hazard rates for the age at first drink data. We will examine the plot in the following paragraphs. Note that Minitab computes the estimated hazard rates using an expression different from Formula (9.15) (it restricts the rate to fall between 0 and 1), so it is recommended that the R software be used to construct the plot of the estimated hazard function.</p>
<p>From the Kaplan–Meier curve in Figure 9.10, we can observe that the estimated proportion of individuals who had not taken their first drink decreases rapidly after age 13. What does this mean in terms of the estimated hazard rates? Examine Figure 9.10, which was produced using the R statistical software. Part (a) displays the Kaplan–Meier curve <span class="math inline">\(\hat S(t)_{\mathrm{KM}}\)</span>, while Part (b) displays the estimated hazard curve <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span>.</p>
<p>Although not practical, we could interpret the estimated hazard rate for each time interval as was done for
the chip melting data. Instead, if possible, we should try to summarize some of the aspects of the estimated
hazard curve in terms of periods of low and/or high risk of event occurrence.</p>
<p>As mentioned earlier, the estimated hazard curve exhibits a rough and erratic pattern. But we can observe
a sharp increase in <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> from about 13 years to about 18 years. This seems to suggest that individuals who have not yet tried alcohol are at high risk of having their first drink during their adolescent and teenage years,
possibly because of peer pressure from their friends in junior and senior high school. The estimated hazard
curve drops right after age 18, but note the age at which it spikes back up again! For those individuals who
have not yet had alcohol by age 21, the estimated hazard rate suddenly jumps to its highest point, indicating
that drinking is likely to occur among 21-year-olds who have never had alcohol before. After age 22, the
estimated hazard decreases until about 25 years, when there is another sudden increase. The curve generally
decreases after age 26 and levels off at about 34 years of age.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_10.png" alt="Estimated survival probabilities and estimated hazard rates for the age at first drink data." width="100%"><p class="caption">
(#fig:fig9.10)Estimated survival probabilities and estimated hazard rates for the age at first drink data.
</p>
</div>
<p><br>
The estimated hazard rate assesses conditional risk at a specific moment in time for individuals in the sample. It is defined as the rate at which individuals in the sample who have not already experienced the target event will do so in the next small interval of time. The estimated hazard function shows how the conditional risk of event occurrence changes over time for a sample of subjects.<br></p>
</div>
<div id="college-graduation" class="section level2 unnumbered">
<h2>College Graduation<a class="anchor" aria-label="anchor" href="#college-graduation"><i class="fas fa-link"></i></a>
</h2>
<p>How long does it take for students to graduate from college? At what time(s) during their college career are they most likely to graduate? Perhaps you have just started college and have a few years to go, or maybe you’re planning to graduate soon. We can investigate the number of years needed to complete the requirements for a bachelor’s degree using data from individuals who participated in the National Educational Longitudinal Survey (NELS) from 1988 to 2002. To illustrate how survival analysis techniques can be used to answer these questions, we will use data on a sample of 1000 participants from the NELS data set who began college prior to the year 2000. Note that this sample includes individuals who began study at any community college or bachelor’s degree–granting postsecondary institution, even though some students who began their postsecondary education at a two-year college may not have been intending to pursue a bachelor’s degree.</p>
<p>The time-to-event random variable is the number of years taken to complete the requirements for a bachelor’s degree. If an individual had obtained a bachelor’s degree by the interview date, then her or his event time is complete. If the student had dropped out or had not graduated by the interview date, then her or his time is right censored.</p>
</div>
<div id="extended-activity-college-graduation" class="section level2 unnumbered">
<h2>Extended Activity: College Graduation<a class="anchor" aria-label="anchor" href="#extended-activity-college-graduation"><i class="fas fa-link"></i></a>
</h2>
<p>Data set: Graduate<br>
45. Use the software instructions provided to plot the estimated hazard rates for the college graduation data.<br>
46. Although the estimated hazard curve may not exhibit a distinguishable pattern, discuss some important features of the curve.<br>
47. Indicate periods of time during their college career when students are at their lowest and highest risk of graduating college. Does your answer match your common understanding of when students typically graduate from college?</p>
</div>
<div id="the-cumulative-hazard-function" class="section level2" number="8.9">
<h2>
<span class="header-section-number">8.9</span> <strong>The Cumulative Hazard Function</strong><a class="anchor" aria-label="anchor" href="#the-cumulative-hazard-function"><i class="fas fa-link"></i></a>
</h2>
<p>The coarse nature of the estimated hazard function can make it difficult to describe or summarize how the conditional risk of event occurrence changes over time. An alternative method for assessing and describing how hazard rates change over time is to investigate the accumulation of the hazard rates over time and look for patterns in the <strong>cumulative hazard</strong>. The function that allows us to examine accumulated hazard over time is called the <strong>cumulative hazard function</strong>. By examining the cumulative hazard function, we can detect when the hazard is increasing, decreasing, or remaining relatively constant.</p>
<div id="motorist-reaction-times" class="section level3 unnumbered">
<h3>Motorist Reaction Times<a class="anchor" aria-label="anchor" href="#motorist-reaction-times"><i class="fas fa-link"></i></a>
</h3>
<p>Have you ever been frustrated because you were stuck behind a car that was stopped in front of you for no apparent reason? Did you feel inclined to honk your horn (or make some other gesture)? In a study on aggressive behavior displayed by motorists, Diekmann and his colleagues investigated the time it took for 57 motorists intentionally blocked at a green light by a Volkswagen Jetta to show signs of aggression.^12 Signs of aggression included honking their horn or beaming their headlights at the Jetta. The time-to-event variable is the time (measured in seconds to the nearest hundredth of a second) until the motorist honked (or beamed the headlights) at the Jetta. If the motorist did not honk or flash the headlights by the time the Jetta moved, then the motorist’s event time was right censored.</p>
<p>The Kaplan–Meier survival curve and the estimated hazard function for the motorist reaction time data are displayed in Figure 9.11. The estimated hazard function behaves erratically and displays several spikes, making it very difficult to assess how the hazard rate is changing over time.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_11.png" alt="Estimated survival probabilities and estimated hazard rates for the time until the motorist displays aggressive behavior." width="100%"><p class="caption">
(#fig:fig9.11)Estimated survival probabilities and estimated hazard rates for the time until the motorist displays aggressive behavior.
</p>
</div>
<p>Similar to the survival function and hazard function, we can define a cumulative hazard function for a population and a sample. We will denote the population cumulative hazard function by <span class="math inline">\(H(t)\)</span>, and the estimator of the cumulative hazard function by <span class="math inline">\(\widehat H(t)_{\mathrm{KM}}\)</span>. The definition of <span class="math inline">\(H(t)\)</span> is given by</p>
<blockquote>
<p><span class="math inline">\(H(t)\)</span> = the accumulation of the hazard rate <span class="math inline">\(h(t)\)</span> for time <span class="math inline">\(T\)</span> between 0 and <span class="math inline">\(t\)</span> for subjects in the population</p>
</blockquote>
<p>A background in calculus is necessary to fully understand and appreciate the definition of the cumulative hazard function <span class="math inline">\(H(t)\)</span>. We present it at the end of this section as a mathematical note. In this section we will look at the reasons for examining the cumulative hazard function, and then in Section 9.8 we will discuss computation of the estimated cumulative hazard function.</p>
<p>An important point to make is that the cumulative hazard function <span class="math inline">\(H(t)\)</span> is neither a probability nor a rate. It is an accumulation of (hazard) rates over time. Since <span class="math inline">\(H(t)\)</span> is cumulative, it never decreases (and rarely remains constant). Furthermore, we can gain a better idea of how hazard changes over time by examining the nature of the change in <span class="math inline">\(H(t)\)</span>—that is, whether the rate of change in <span class="math inline">\(H(t)\)</span> is increasing or decreasing.</p>
<p>To better understand what is meant by an increase or decrease in the rate of change in <span class="math inline">\(H(t)\)</span>, consider Figure 9.12. The dashed line represents the population cumulative hazard function <span class="math inline">\(H(t)\)</span>, and the values of the slopes of the four solid lines represent estimates of the rates of increase in <span class="math inline">\(H(t)\)</span> over the corresponding four time periods. Observe that <span class="math inline">\(H(t)\)</span> increases over the entire range of time, but the rates of increase (the values of the four slopes) vary over the course of time. The slopes of the first three lines are decreasing, implying that the rate of change in <span class="math inline">\(H(t)\)</span> decreases until about time <span class="math inline">\(t = 4\)</span>. The slope of the fourth line is greater than the previous slope, indicating that the rate of change <em>increases</em> after time <span class="math inline">\(t = 4\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_12.png" alt="Cumulative hazard function displaying various rates of change over time" width="100%"><p class="caption">
(#fig:fig9.12)Cumulative hazard function displaying various rates of change over time
</p>
</div>
<p>In general, we can examine how the rate of change in the cumulative hazard function changes over time to understand how the hazard function, <span class="math inline">\(h(t)\)</span>, changes over time.</p>
<ul>
<li>If the <em>rate</em> of change in <span class="math inline">\(H(t)\)</span> is <em>increasing</em> (over an interval of time), then <span class="math inline">\(h(t)\)</span> is increasing (over the same interval of time).</li>
<li>If the <em>rate</em> of change in <span class="math inline">\(H(t)\)</span> is <em>decreasing</em>, then <span class="math inline">\(h(t)\)</span> is decreasing.<br>
</li>
<li>If the <em>rate</em> of change in <span class="math inline">\(H(t)\)</span> is <em>constant</em> (and greater than 0), then <span class="math inline">\(h(t)\)</span> is constant (and greater than 0).<br>
</li>
<li>If the <em>rate</em> of change in <span class="math inline">\(H(t)\)</span> is 0, then <span class="math inline">\(h(t)\)</span> is 0.</li>
</ul>
<p>Figure 9.13 presents the hazard functions originally shown in Figure 9.8 and their corresponding cumulative hazard functions. We can see that if the hazard rate is constant over time [Part (a)], then the cumulative hazard function [Part (c)] will increase at a <em>constant</em> rate—that is, there is a perfect positive linear relationship between values of t and values of H(t). If the hazard rate is increasing linearly over time [Part (b)], then the rate of change in H(t) is increasing [Part (d)].</p>
<p><br>
Assuming a particular probability distribution for <span class="math inline">\(T\)</span>, the mathematical definition of <span class="math inline">\(H(t)\)</span> requires integral calculus and is given by
<span class="math display">\[\begin{align}
H(t) &amp;= \int_{0}^{t} h(x)\,dx
\tag{9.16}
\end{align}\]</span>
In general, <span class="math inline">\(H(t)\)</span> increases as <span class="math inline">\(t\)</span> increases [<span class="math inline">\(H(t)\)</span> is constant only when <span class="math inline">\(h(t) = 0\)</span>]. Also note that <span class="math inline">\(H(t)\)</span> is neither a rate nor a probability (it is an accumulation of rate over time).<br></p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_13.png" alt="Population hazard functions and their corresponding cumulative hazard functions." width="100%"><p class="caption">
(#fig:fig9.13)Population hazard functions and their corresponding cumulative hazard functions.
</p>
</div>
</div>
</div>
<div id="estimator-of-the-cumulative-hazard-function" class="section level2 unnumbered">
<h2>Estimator of the Cumulative Hazard Function<a class="anchor" aria-label="anchor" href="#estimator-of-the-cumulative-hazard-function"><i class="fas fa-link"></i></a>
</h2>
<p>Since <span class="math inline">\(H(t)\)</span> is an accumulation of the population hazard <span class="math inline">\(h(t)\)</span> between time 0 and time <span class="math inline">\(t\)</span>, it makes intuitive sense that an estimator of <span class="math inline">\(H(t)\)</span> should also accumulate (or sum up) the estimated hazard rates computed between time 0 and time <span class="math inline">\(t\)</span>. This is the approach we will take.</p>
<p>Once again, we will start with intervals of time defined as if we were computing the Kaplan–Meier estimator. Then, given the estimated hazard rates <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> for <span class="math inline">\(t_i \le t &lt; t_{i+1}\)</span>, we can calculate the total estimated hazard during each time interval <span class="math inline">\([t_i,\,t_{i+1})\)</span> for <span class="math inline">\(i = 1,\dots,m-1\)</span>, given by</p>
<p><span class="math display">\[
\text{Total estimated hazard during }[t_i,\,t_{i+1}) \;=\; \hat h(t)_{\mathrm{KM}} \times (t_{i+1} - t_i)
\]</span></p>
<p>where <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> is the estimated hazard rate for <span class="math inline">\(t_i \le t &lt; t_{i+1}\)</span> and <span class="math inline">\(t_{i+1} - t_i\)</span> is the width of the <span class="math inline">\(i\)</span>th interval. Then the Nelson–Aalen estimator of <span class="math inline">\(H(t)\)</span>, denoted <span class="math inline">\(\widehat H(t)_{\mathrm{NA}}\)</span>, is simply the sum of these total estimated hazard quantities up to a particular time <span class="math inline">\(t\)</span>, given by</p>
<p><span class="math display">\[\begin{align}
\widehat H(t)_{\mathrm{NA}} &amp;= \sum_{t_i \le t} \bigl[\hat h(t)_{\mathrm{KM}}\times (t_{i+1} - t_i)\bigr]
\tag{9.17}
\end{align}\]</span></p>
<p>Note the following details about <span class="math inline">\(\widehat H(t)_{\mathrm{NA}}\)</span>, depending on whether the last observed event time is censored
or complete:
• If the largest observed event time, denoted <span class="math inline">\(t_n\)</span>, is censored, then <span class="math inline">\(\widehat H(t)_{\mathrm{NA}}\)</span> will peak (reach its highest
point) at the last complete event time, <span class="math inline">\(t_m\)</span>, and then extend to tn—that is, it will be constant over the
interval [<span class="math inline">\(t_m\)</span>, <span class="math inline">\(t_n\)</span>) (see Figure 9.14 for example).
• Otherwise, if the last observed event time is complete, then <span class="math inline">\(\widehat H(t)_{\mathrm{NA}}\)</span> will simply reach its highest value
at the complete time, <span class="math inline">\(t_m\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_14.png" alt="Estimated hazard function and estimated cumulative hazard function for the chip melting data." width="100%"><p class="caption">
(#fig:fig9.14)Estimated hazard function and estimated cumulative hazard function for the chip melting data.
</p>
</div>
</div>
<div id="extended-activity-estimated-cumulative-hazard-function" class="section level2 unnumbered">
<h2>Extended Activity: Estimated Cumulative Hazard Function<a class="anchor" aria-label="anchor" href="#extended-activity-estimated-cumulative-hazard-function"><i class="fas fa-link"></i></a>
</h2>
<ol start="48" style="list-style-type: decimal">
<li>Use Equation (9.17) and the quantities in Table 9.6 to compute <span class="math inline">\(\widehat H(t)_{\mathrm{NA}}\)</span> for the chip melting times from Table 9.2 by hand.</li>
</ol>
<p>As discussed earlier in connection with the population cumulative hazard function <span class="math inline">\(H(t)\)</span>, we can also examine how the rate of change in the estimated cumulative hazard, <span class="math inline">\(\widehat H(t)_{\mathrm{NA}}\)</span>, changes over time, to investigate changes in the estimated hazard function over time.</p>
<ul>
<li>If the <em>rate of change</em> in <span class="math inline">\(\widehat H(t)_{\mathrm{NA}}\)</span> is <em>increasing</em> (over an interval of time), then <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> is increasing (over the same interval of time).<br>
</li>
<li>If the <em>rate of change</em> in <span class="math inline">\(\widehat H(t)_{\mathrm{NA}}\)</span> is <em>decreasing</em>, then <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> is decreasing.<br>
</li>
<li>If the <em>rate of change</em> in <span class="math inline">\(\widehat H(t)_{\mathrm{NA}}\)</span> is <em>constant</em> (and greater than 0), then <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> is constant (and greater than 0).<br>
</li>
<li>If the <em>rate of change</em> in <span class="math inline">\(\widehat H(t)_{\mathrm{NA}}\)</span> is 0, then <span class="math inline">\(\hat h(t)_{\mathrm{KM}}\)</span> is 0.</li>
</ul>
<p>Figure 9.14 displays the estimated hazard curve for the chip melting times (shown earlier in Figure 9.9) in Part (a) and the estimated cumulative hazard function in Part (b). Because of the small number of intervals, it is difficult to determine if the rate of change in <span class="math inline">\(\widehat H(t)_{\mathrm{NA}}\)</span> is increasing or decreasing.</p>
<p>Let’s return to the motorist reaction time data. As we’ve already seen, the estimated hazard function dis-
played several spikes, but the overall pattern was difficult to summarize. Figure 9.15 displays the estimated
hazard and cumulative hazard functions.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_15.png" alt="Estimated hazard function and estimated cumulative hazard function for the aggressive motorist behavior." width="100%"><p class="caption">
(#fig:fig9.15)Estimated hazard function and estimated cumulative hazard function for the aggressive motorist behavior.
</p>
</div>
<p>We can summarize the rates of increase and decrease in the estimated cumulative hazard function
shown in Part (b) of Figure 9.15 and describe the changes in the estimated hazard function. The rate of
change in the estimated cumulative hazard is slowest between seconds 1.5 and 2.5 and is then followed by
a higher rate of change for the next 2.5 seconds. Between the 5th and the 8th second the rate of change in
the estimated cumulative hazard decreases, and then after the 8th second the rate of change remains fairly
constant. From this general description of H n(t)NA we can summarize the changes in the estimated hazard
rates. Hazard increases between seconds 1.5 and 2.5, but is somewhat low, and then increases substantially
between the 2.5th and the 5th second. We might consider this period of time to be the “boiling point” of
frustration, when motorists who have not done so already are most likely to become impatient and decide
to honk their horn or flash their high beams. Between the 5th and the 8th second, hazard decreases, after
which it levels off.</p>
<p>
The cumulative hazard function is a useful graphical display for describing the accumulation of hazard
over time and for showing particular time periods when risk is high.
</p>
</div>
<div id="time-to-rearrest-for-former-inmates" class="section level2 unnumbered">
<h2>Time to Rearrest for Former Inmates<a class="anchor" aria-label="anchor" href="#time-to-rearrest-for-former-inmates"><i class="fas fa-link"></i></a>
</h2>
<p>For 36 months, Henning and Frueh followed criminal activities of 194 inmates released from a medium security prison.<span class="math inline">\(^13\)</span> We can use the data from their study to investigate the time until the former inmates were rearrested. If the former inmate had been rearrested for a criminal act before 36 months (after initial prison release) had passed, then that former inmate’s event time is complete. If the former inmate had not been rearrested for a criminal act after 36 months had passed or had completely dropped out of the study, then that former inmate’s event time is right censored. In addition to the time until rearrest, measurements are also available on the following variables:</p>
<blockquote>
<p><em>person</em>: a dichotomous variable identifying former inmates who had a history of person-related crimes—that is, those with one or more convictions for offenses such as aggravated assault or kidnapping<br><em>property</em>: a dichotomous variable indicating whether former inmates had been convicted of a property-related crime<br><em>cenage</em>: the “centered” age of the individual—that is, the difference between the age of the individual on release and the average age of all inmates in the study</p>
</blockquote>
</div>
<div id="extended-activity-estimated-cumulative-hazard-function-1" class="section level2 unnumbered">
<h2>Extended Activity: Estimated Cumulative Hazard Function<a class="anchor" aria-label="anchor" href="#extended-activity-estimated-cumulative-hazard-function-1"><i class="fas fa-link"></i></a>
</h2>
<p>Data set: <span class="math inline">\(Rearrest\)</span>
49. Use statistical software to construct the estimated hazard function and the cumulative hazard function for the time to rearrest data.<br>
50. The estimated hazard function will be difficult to describe, but try to explain how the risk of rearrest changes over time based on the estimated cumulative hazard function. When does the risk of being rearrested appear to be the highest? The lowest?</p>
<p><br>
In this chapter, we have focused primarily on estimating the population survival, hazard, and cumulative hazard functions based on a sample of survival times. The models that we have fit to data are sometimes referred to as <strong>nonparametric</strong> since we haven’t assumed anything about the shape of the distribution of the survival time random variable <span class="math inline">\(T\)</span> (e.g., whether <span class="math inline">\(T\)</span> is normally distributed). You may wonder what we can do if the distribution of <span class="math inline">\(T\)</span> is known. A class of models called <strong>parametric models</strong> can sometimes be used to represent the survival function, hazard function, and cumulative hazard function if we know (or have a pretty good idea about) the exact distribution of <span class="math inline">\(T\)</span> (this was mentioned briefly in the discussion of the survival function). With the exception of a few simple graphical examples and brief descriptions, our discussion of parametric models has been very limited, and we have not provided any explicit formulas for <span class="math inline">\(S(t)\)</span>, <span class="math inline">\(h(t)\)</span>, or <span class="math inline">\(H(t)\)</span>.<span class="math inline">\(^{14}\)</span><br></p>
</div>
<div id="additional-types-of-incomplete-data" class="section level2" number="8.10">
<h2>
<span class="header-section-number">8.10</span> <strong>Additional Types of Incomplete Data</strong><a class="anchor" aria-label="anchor" href="#additional-types-of-incomplete-data"><i class="fas fa-link"></i></a>
</h2>
<p>Throughout our discussions of survival analysis techniques, we’ve assumed that any incomplete data are due to right censoring. In Section 9.2, you learned that right censoring occurs when observation of an individual begins at a defined starting time and ends before the outcome of interest is observed. In this section, we’ll describe two other censoring mechanisms, left censoring and interval censoring, and two selection processes that determine whether individuals will be included in the study, left truncation and right truncation.</p>
</div>
<div id="left-censoring-and-interval-censoring" class="section level2 unnumbered">
<h2>Left Censoring and Interval Censoring<a class="anchor" aria-label="anchor" href="#left-censoring-and-interval-censoring"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Left censoring</strong> occurs when the event of interest is known to have occurred before the study began.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Technically, left censoring can occur after a study has started if the event of interest occurred prior to a particular recorded time. For example, a subject may experience an event of interest during the course of a study (such as contracting a disease) but not know the exact time of the event (knowing only that it occurred prior to testing positive for the disease).&lt;/p&gt;"><sup>7</sup></a> For an individual with a left-censored survival time, we know that the study start time is greater than the time at which the event of interest occurred.</p>
<p>To see the difference between right censoring and left censoring, examine Figure 9.16. Figure 9.16 displays the target event times of four subjects. For now, we’ll assume that time is measured in months. We’ll discuss subjects 1, 3, and 4 first. Subject 1 entered the study at time 2 and experienced the target event at time 8, so subject 1 has a complete target event time of 6 months. Subject 3 entered the study at time 3, but dropped out of the study at time 7. Hence, subject 3 has a right-censored event time of 4 months. This means that subject 3’s event time is <em>at least</em> 4 months. Finally, subject 4 entered the study at time 2 and had not experienced the event by the end of the study at time 9. Subject 4 has a right-censored event time of 7 months.</p>
<div class="figure" style="text-align: center">
<img src="docs/Fig9_16.png" alt="Observed survival times for four subjects. X indicates the target event occurred at displayed time; O indicates the target event was not observed (event time is censored); &lt; indicates when Subject 2 was first observed in the study." width="100%"><p class="caption">
(#fig:fig9.16)Observed survival times for four subjects. X indicates the target event occurred at displayed time; O indicates the target event was not observed (event time is censored); &lt; indicates when Subject 2 was first observed in the study.
</p>
</div>
<p>Subject 2 is rather interesting. Subject 2 experienced the event prior to the beginning of the study but was not observed until time 2. In other words, subject 2’s observed event time is <em>greater</em> than her exact event time. Her event time is left censored.</p>
<p><strong>Interval censoring</strong> occurs when the event of interest is known to have occurred between two time points, but the precise time is not known.</p>
</div>
<div id="extended-activity-left-censoring-and-interval-censoring" class="section level2 unnumbered">
<h2>Extended Activity: Left Censoring and Interval Censoring<a class="anchor" aria-label="anchor" href="#extended-activity-left-censoring-and-interval-censoring"><i class="fas fa-link"></i></a>
</h2>
<ol start="51" style="list-style-type: decimal">
<li>
<strong>Counting to Ten</strong> A child development researcher is interested in the age at which children first learn to count to 10. A particular child in the study was 2 years old and had already learned to count to 10 when the researcher interviewed her parents; however, the parents couldn’t remember exactly how old she was when she first counted to 10. Briefly explain why this particular child’s event time is left censored.<br>
</li>
<li>
<strong>Type 2 Diabetes</strong> In a study to determine whether exposure to oral contraceptives increases the risk of developing type 2 diabetes among Latina women with prior gestational diabetes mellitus (GDM), women who had recently given birth and had been previously diagnosed with GDM were screened for type 2 diabetes at intervals ranging from every three months to every year during the period of the study (1987–1994).<span class="math inline">\(^{15}\)</span> Briefly explain why the times to develop type 2 diabetes were interval censored.</li>
</ol>
<p>
Left and interval censoring are two additional mechanisms that lead to incomplete observations. Left censoring occurs when the exact time an event occurred is unknown; it is known only that the event occurred prior to a particular time <span class="math inline">\(t\)</span>. Interval censoring occurs when the event time is known only to have occurred between two time points.
</p>
</div>
<div id="chapter-summary-2" class="section level2 unnumbered">
<h2>
<strong>Chapter Summary</strong><a class="anchor" aria-label="anchor" href="#chapter-summary-2"><i class="fas fa-link"></i></a>
</h2>
<p>The goal of this chapter was to provide an overview of time-to-event data and expose you to some introductory techniques for exploring survival data. A sample of event times can be summarized using the Kaplan–Meier curve, in conjunction with descriptive measures such as the mean and median.</p>
<p>The Kaplan–Meier estimator of the probability of survival beyond time <span class="math inline">\(t\)</span> is given by
<span class="math display">\[\begin{align}
\hat S(t)_{\mathrm{KM}} &amp;= \prod_{t_i \le t} \Bigl(1 - \frac{d_i}{n_i}\Bigr).
\tag{9.2}
\end{align}\]</span></p>
<p>Other descriptive statistics can be computed for the observed event times, including the mean survival time and percentiles of survival time. If the largest complete event time is identical to the largest observed event time, the estimator of the mean survival time is
<span class="math display">\[\begin{align}
\hat \mu &amp;= \sum_{i=0}^{m-1} \hat S(t_i)_{\mathrm{KM}}\,(t_{i+1} - t_i).
\tag{9.3}
\end{align}\]</span></p>
<p>If the largest event time is censored, the estimator of the mean survival time is
<span class="math display">\[\begin{align}
\hat \mu &amp;= \sum_{i=0}^{m-1} \hat S(t_i)_{\mathrm{KM}}\,(t_{i+1} - t_i)
+ \hat S(t_m)_{\mathrm{KM}}\,(t_n - t_m).
\tag{9.4}
\end{align}\]</span></p>
<p>To estimate the time at which <span class="math inline">\(p\%\)</span> of the subjects had yet to experience the target event, the <span class="math inline">\(p\)</span>th percentile of survival time can be calculated as
<span class="math display">\[\begin{align}
\hat t_{(p)} &amp;= \text{smallest complete event time }t_i\text{ such that }
\hat S(t_i)_{\mathrm{KM}} \le 1 - \frac{p}{100}.
\tag{9.5}
\end{align}\]</span></p>
<p>To provide a range of possible values for the true survival probabilities, confidence intervals based on the Kaplan–Meier estimates can be constructed for <span class="math inline">\(S(t)\)</span> at fixed points in time. The <span class="math inline">\(100(1 - \alpha)\%\)</span> confidence interval for the survival probability <span class="math inline">\(S(t)\)</span> at fixed time <span class="math inline">\(t\)</span> is given by
<span class="math display">\[\begin{align}
\hat S(t)_{\mathrm{KM}} \pm Z_{\alpha/2}\,\mathrm{se}\bigl(\hat S(t)_{\mathrm{KM}}\bigr),
\tag{9.7}
\end{align}\]</span>
where
<span class="math display">\[\begin{align}
\mathrm{se}\bigl(\hat S(t)_{\mathrm{KM}}\bigr)
&amp;= \sqrt{
\bigl(\hat S(t)_{\mathrm{KM}}\bigr)^2
\sum_{t_i \le t} \frac{d_i}{n_i\,(n_i - d_i)}
}.
\tag{9.9}
\end{align}\]</span></p>
<p>The survival experiences of two or more groups of subjects can be compared with the log-rank test or Wilcoxon test. Given sample event times for two groups, the log-rank test statistic for comparing the survival curves for two independent populations is
<span class="math display">\[\begin{align}
\chi^2 &amp;= \frac{\Bigl(\sum_{i=1}^m d_{1i} - \sum_{i=1}^m E_{1i}\Bigr)^2}
{\sum_{i=1}^m V_{1i}}.
\tag{9.12}
\end{align}\]</span></p>
<p>The hazard function assesses the risk that a subject will experience a target event in the next instant given that the subject has not previously experienced the event. The estimated hazard function, constructed from a sample of event times, is given by
<span class="math display">\[\begin{align}
\hat h(t)_{\mathrm{KM}} &amp;= \frac{\hat p_i}{t_{i+1} - t_i},
\end{align}\]</span>
where <span class="math inline">\(\hat p_i = d_i / n_i\)</span> is the estimated conditional probability of experiencing the event in the interval <span class="math inline">\([t_i,\,t_{i+1})\)</span>.</p>
<p>One drawback of the estimated hazard function is that it can exhibit a very erratic pattern, which makes summarizing the data more difficult. An alternative function that can be used to identify periods of constant risk, as well as periods when risk is changing, is the cumulative hazard function, given by
<span class="math display">\[\begin{align}
\widehat H(t)_{\mathrm{NA}}
&amp;= \sum_{t_i \le t}
\bigl[\hat h(t_i)_{\mathrm{KM}}\,(t_{i+1} - t_i)\bigr].
\tag{9.17}
\end{align}\]</span></p>
<p>The estimated cumulative hazard function provides the accumulation of estimated hazard up to a particular time <span class="math inline">\(t\)</span>. These formulas assume right censoring only. If left or interval censoring or left or right truncation are present in your data, alternative methods must be used.</p>
<div id="this-part-not-working.-all-the-text-under-the-heading-is-not-showing-up-6" class="section level3" number="8.10.1">
<h3>
<span class="header-section-number">8.10.1</span> This part not working. All the text under the heading is not showing up<a class="anchor" aria-label="anchor" href="#this-part-not-working.-all-the-text-under-the-heading-is-not-showing-up-6"><i class="fas fa-link"></i></a>
</h3>
</div>
</div>
<div id="exercises-4" class="section level2 unnumbered">
<h2>
<strong>Exercises</strong><a class="anchor" aria-label="anchor" href="#exercises-4"><i class="fas fa-link"></i></a>
</h2>

<div id="this-part-not-working.-all-the-text-under-the-heading-is-not-showing-up-7" class="section level3" number="8.10.2">
<h3>
<span class="header-section-number">8.10.2</span> This part not working. All the text under the heading is not showing up<a class="anchor" aria-label="anchor" href="#this-part-not-working.-all-the-text-under-the-heading-is-not-showing-up-7"><i class="fas fa-link"></i></a>
</h3>
</div>
</div>
<div id="endnotes-3" class="section level2 unnumbered">
<h2>
<strong>Endnotes</strong><a class="anchor" aria-label="anchor" href="#endnotes-3"><i class="fas fa-link"></i></a>
</h2>

<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-R-bookdown" class="csl-entry">
Xie, Yihui. <em>Bookdown: Authoring Books and Technical Documents with r Markdown</em>, 2025. <a href="https://github.com/rstudio/bookdown">https://github.com/rstudio/bookdown</a>.
</div>
<div id="ref-xie2015" class="csl-entry">
———. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC, 2015. <a href="http://yihui.org/knitr/">http://yihui.org/knitr/</a>.
</div>
</div>
</div>
</div>














  <div class="chapter-nav">
<div class="empty"></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Chapter 9</strong>" was written by Your Name. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
